(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a323672"],{"1ba2":function(t,e,i){},"24b5":function(t,e,i){"use strict";i("1ba2")},2909:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var s=i("6b75");function a(t){if(Array.isArray(t))return Object(s["a"])(t)}i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("a630");function n(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var r=i("06c5");i("d9e2");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return a(t)||n(t)||Object(r["a"])(t)||o()}},"74e8":function(t,e,i){"use strict";i.r(e);i("99af"),i("b0c0"),i("a9e3");var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"horse-single-wrapper"},[e("div",{staticClass:"back-wrap"},[e("el-button",{on:{click:t.goBack}},[t._v("返回列表")])],1),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"horse-single-content"},[e("div",{staticClass:"main-info-wrapper"},[t.item.ID?e("div",{staticClass:"title"},[t._v(t._s(t.item.Name)+" 的信息")]):t._e(),t.item.ID?e("el-row",{staticClass:"main-info-wrap",attrs:{gutter:20}},[e("el-col",{staticClass:"main-img-wrap",attrs:{xs:24,sm:8,md:8,lg:8,xl:8}},[e("div",{staticClass:"img-wrap",class:"u-quality-bg--"+t.item.Quality},[t.item.ImgPath?e("img",{staticClass:"u-image",attrs:{src:t.getImgSrc(t.item.ImgPath)}}):e("div",{staticClass:"u-image"})])]),e("el-col",{staticClass:"main-info-content",attrs:{xs:24,sm:16,md:16,lg:16,xl:16}},[e("div",{staticClass:"info-wrap"},[e("div",{staticClass:"info-item"},[t._v("ID: "+t._s(t.item.ID))]),e("div",{staticClass:"info-item name"},[t._v(t._s(t.item.Name))]),e("div",{staticClass:"info-item"},[t._v(" 分类: "+t._s(t.typeName+("2"!==t.type?" · ".concat(t.modeName," · ").concat(t.item.GetType):""))+" ")]),e("div",{staticClass:"info-item"},[t._v("品质: "+t._s(t.item.Level))]),"2"!==t.type?e("div",{staticClass:"info-item"},[t._v("跑速: "+t._s(t.speedName))]):t._e(),"2"!==t.type?e("div",{staticClass:"info-item"},[t._v("饲料: "+t._s(t.feedName))]):t._e(),t.basicAttrs.length?e("div",{staticClass:"info-list"},[e("div",{staticClass:"title"},[t._v("基础属性")]),e("div",{staticClass:"basic-list"},t._l(t.basicAttrs,(function(i){return e("div",{key:i.id,staticClass:"item"},[t._v(" "+t._s(i.desc)+" ")])})),0)]):t._e(),t.magicAttrs.length?e("div",{staticClass:"info-list"},[e("div",{staticClass:"title"},[t._v("特殊属性")]),e("div",{staticClass:"list"},t._l(t.magicAttrs,(function(i,s){return e("div",{key:s,staticClass:"u-attr"},[e("el-tooltip",{attrs:{trigger:"hover",placement:"top"}},[e("div",{staticClass:"u-attr-pop",attrs:{slot:"content"},slot:"content"},[i.name?e("div",{staticClass:"u-attr-name"},[t._v(" "+t._s((i.name||"")+(Number(i.level)?i.level+"级":""))+" ")]):t._e(),e("div",{staticClass:"u-attr-desc"},[t._v(t._s(i.desc))])]),e("img",{staticClass:"u-attr-icon",attrs:{src:i.iconUrl,alt:i.name}})])],1)})),0)]):t._e(),e("a",{staticClass:"u-link",attrs:{href:t.getLink("item",this.id),target:"_blank"}},[e("i",{staticClass:"el-icon-collection-tag"}),t._v(" 物品信息 ")])])])],1):e("div",[t._v("无此信息")])],1),t.sameList.length?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.sameLoading,expression:"sameLoading"}],staticClass:"same-list-container"},[e("div",{staticClass:"title"},[t._v("同类坐骑")]),e("same-list",{attrs:{list:t.sameList}})],1):t._e(),t.wiki_post&&t.wiki_post.post?e("div",{staticClass:"m-wiki-post-panel"},[e("WikiPanel",{attrs:{"wiki-post":t.wiki_post}},[e("template",{slot:"head-title"},[e("svg",{class:"u-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"512",height:"512",viewBox:"0 0 512 512","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M382.5 109.2C345.1 71.8 296.3 50 243.9 47v110.9c46.7 19.2 79.6 65.2 79.6 118.7 0 58-47.2 105.2-105.2 105.2-47.8 0-86.6-38.9-86.6-86.6 0-39.6 32.2-71.8 71.8-71.8 33.1 0 59.9 26.9 59.9 59.9h-25c0-19.3-15.7-34.9-34.9-34.9-25.8 0-46.8 21-46.8 46.8 0 34 27.6 61.6 61.6 61.6 44.2 0 80.1-35.9 80.1-80.1 0-57-46.3-103.3-103.3-103.3C122.3 173.3 63 232.6 63 305.6 63 398.4 138.5 474 231.4 474c57.1 0 110.7-22.2 151.1-62.6 40.4-40.4 62.6-94 62.6-151.1s-22.2-110.7-62.6-151.1z"}})]),e("span",{staticClass:"u-txt"},[t._v("物品攻略")])]),e("template",{slot:"head-actions"},[e("a",{staticClass:"el-button el-button--primary",attrs:{href:t.publish_url("item/".concat(t.id))}},[e("i",{staticClass:"el-icon-edit"}),e("span",[t._v("完善物品攻略")])])]),e("template",{slot:"body"},[t.compatible?e("div",{staticClass:"m-wiki-compatible"},[e("i",{staticClass:"el-icon-warning-outline"}),t._v(" 暂无缘起攻略，以下为重制攻略，仅作参考，"),e("a",{staticClass:"s-link",attrs:{href:t.publish_url("item/".concat(t.id))}},[t._v("参与修订")]),t._v("。 ")]):t._e(),e("Article",{attrs:{content:t.wiki_post.post.content}}),e("div",{staticClass:"m-wiki-signature"},[e("i",{staticClass:"el-icon-edit"}),t._v(" 本次修订由 "),e("b",[t._v(t._s(t.user_name))]),t._v(" 提交于"+t._s(t.updated_at)+" ")]),e("Thx",{key:"item-thx-"+t.id,staticClass:"m-thx",attrs:{postId:t.id,postType:"item",postTitle:t.wiki_post.source.Name,userId:t.author_id,adminBoxcoinEnable:!0,userBoxcoinEnable:!0,authors:t.authors,mode:"wiki",client:t.client}})],1)],2),e("WikiRevisions",{attrs:{type:"item","source-id":t.id}}),e("WikiComments",{attrs:{type:"item","source-id":t.id}})],1):e("div",{staticClass:"m-wiki-post-empty"},[e("i",{staticClass:"el-icon-s-opportunity"}),e("span",[t._v("暂无攻略，我要")]),e("a",{staticClass:"s-link",attrs:{href:t.publish_url("item/".concat(t.id))}},[t._v("完善攻略")])])])])},a=[],n=(i("4de4"),i("d3b7"),i("d81d"),i("7db0"),i("fb6a"),i("14d9"),i("ac1f"),i("466d"),i("5319"),i("f252")),r=i("85e4"),o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"same-list-wrapper"},t._l(t.list,(function(i){return e("div",{key:i.ID,staticClass:"same-item"},[e("div",{staticClass:"img-wrap",class:"u-quality-bg--"+i.Quality},[i.ImgPath?e("img",{staticClass:"u-image",attrs:{src:i.imgUrl}}):e("div",{staticClass:"u-image"})]),e("div",{staticClass:"info-wrap"},[e("div",{staticClass:"info-item"},[t._v(t._s(i.Name))]),e("div",{staticClass:"info-item"},[t._v("ID: "+t._s(i.ID))]),e("div",{staticClass:"info-item u-attr-wrap"},[e("div",{staticClass:"u-attr-content"},t._l(i.MagicAttributes||[],(function(i,s){return e("div",{key:s,staticClass:"u-attr"},[e("el-tooltip",{attrs:{trigger:"hover",placement:"top"}},[e("div",{staticClass:"u-attr-pop",attrs:{slot:"content"},slot:"content"},[i.name?e("div",{staticClass:"u-attr-name"},[t._v(" "+t._s((i.name||"")+(Number(i.level)?i.level+"级":""))+" ")]):t._e(),e("div",{staticClass:"u-attr-desc"},[t._v(t._s(i.desc))])]),e("img",{staticClass:"u-attr-icon",attrs:{src:i.iconUrl,alt:i.name}})])],1)})),0)])])])})),0)},c=[],l={name:"SameList",props:{list:{type:Array,required:!0}},methods:{}},u=l,m=(i("8ecf"),i("2877")),d=Object(m["a"])(u,o,c,!1,null,null,null),p=d.exports,v=i("9616"),_=i("1b86"),f=i("a974"),g=i("662c"),h=i("9307"),y=function(){var t=this,e=t._self._c;return e("WikiPanel",{staticClass:"c-wiki-comments",attrs:{scene:"detail"}},[e("template",{slot:"head-title"},[e("i",{staticClass:"el-icon-chat-line-round"}),e("span",[t._v("百科评论")])]),e("template",{slot:"body"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-comments-panel"},[t.comments&&t.comments.length?t._e():e("div",{staticClass:"u-empty"},[null===t.comments?e("span",[t._v("🎉 数据加载中...")]):t._e(),!1===t.comments?e("span",[t._v("⚠️ 数据加载异常")]):t._e(),t.comments&&!t.comments.length?e("span",[t._v("💧 暂无评论")]):t._e()]),e("Comment",{attrs:{comments:t.comments,"source-id":t.sourceId}}),e("el-pagination",{staticClass:"u-pagination-box",attrs:{background:"","hide-on-single-page":"","current-page":t.page,total:t.total,"page-size":t.pageSize,layout:"prev, pager, next, total"},on:{"current-change":t.handleCurrentChange}}),e("div",{staticClass:"m-reply-form",attrs:{id:"m-reply-form"}},[e("h4",{staticClass:"u-title"},[e("i",{staticClass:"el-icon-chat-dot-round"}),e("span",[t._v("回复")])]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reply_form.content,expression:"reply_form.content"}],staticClass:"u-reply-content",domProps:{value:t.reply_form.content},on:{input:function(e){e.target.composing||t.$set(t.reply_form,"content",e.target.value)}}}),e("div",{staticClass:"u-author"},[e("span",[t._v("昵称：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.reply_form.user_nickname,expression:"reply_form.user_nickname"}],attrs:{type:"text"},domProps:{value:t.reply_form.user_nickname},on:{input:function(e){e.target.composing||t.$set(t.reply_form,"user_nickname",e.target.value)}}})]),e("el-button",{staticClass:"u-submit",attrs:{type:"primary"},on:{click:function(e){return t.create_comment(t.reply_form)}}},[e("i",{staticClass:"el-icon-check"}),e("span",[t._v("提交")])])],1)],1)])],2)},C=[],b=(i("caad"),i("2532"),function(){var t=this,e=t._self._c;return e("ul",{staticClass:"u-comments"},t._l(t.comments,(function(i,s){return e("li",{key:s,staticClass:"u-comment-panel"},[e("div",{staticClass:"u-comment"},[e("div",{staticClass:"u-nickname-panel"},[e("a",{staticClass:"u-nickname",attrs:{href:i.user_id?t.author_url(i.user_id):null,target:"_blank"},domProps:{textContent:t._s(i.user_nickname)}}),i.parent_id?[e("span",[t._v(" 回复 ")]),e("a",{staticClass:"u-nickname",attrs:{href:i.parent.user_id?t.author_url(i.parent.user_id):null,target:"_blank"},domProps:{textContent:t._s(i.parent.user_nickname)}})]:t._e()],2),e("p",{staticClass:"u-content",domProps:{innerHTML:t._s(i.content)}}),e("div",{staticClass:"m-reply"},[i.reply_form&&i.reply_form.show?e("el-button",{staticClass:"u-reply",attrs:{type:"default"},on:{click:function(t){i.reply_form.show=!i.reply_form.show}}},[e("i",{staticClass:"el-icon-arrow-up"}),e("span",[t._v("收起")])]):e("el-button",{staticClass:"u-reply",attrs:{type:"primary",plain:""},on:{click:function(t){i.reply_form.show=!i.reply_form.show}}},[e("i",{staticClass:"el-icon-chat-dot-round"}),e("span",[t._v("回复")])]),e("span",{staticClass:"u-time",domProps:{textContent:t._s(t.ts2str(i.updated))}})],1),i.reply_form&&i.reply_form.show?e("div",{staticClass:"m-reply-form"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:i.reply_form.content,expression:"comment.reply_form.content"}],staticClass:"u-reply-content",domProps:{value:i.reply_form.content},on:{input:function(e){e.target.composing||t.$set(i.reply_form,"content",e.target.value)}}}),e("div",{staticClass:"u-author"},[e("span",[t._v("昵称：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:i.reply_form.user_nickname,expression:"comment.reply_form.user_nickname"}],attrs:{type:"text"},domProps:{value:i.reply_form.user_nickname},on:{input:function(e){e.target.composing||t.$set(i.reply_form,"user_nickname",e.target.value)}}})]),e("el-button",{staticClass:"u-submit",attrs:{type:"primary"},on:{click:function(e){return t.create_comment(i.reply_form,i.id)}}},[e("i",{staticClass:"el-icon-check"}),e("span",[t._v("提交")])])],1):t._e()]),i.children.length?e("WikiComment",{attrs:{comments:i.children,"source-id":t.sourceId}}):t._e()],1)})),0)}),k=[],w={name:"WikiComment",props:["comments","sourceId"],methods:{author_url:r["authorLink"],ts2str:r["ts2str"],create_comment:function(t,e){var i=this.$parent;i.create_comment||(i=i.$parent),i.create_comment?i.create_comment(t,e):this.$message({message:"发布评论异常，请联系管理员",type:"warning"})}}},x=w,I=Object(m["a"])(x,b,k,!1,null,null,null),N=I.exports,S=i("c9d2"),A={name:"WikiComments",props:["type","sourceId"],data:function(){return{comments:null,reply_form:{content:"",user_nickname:S["a"].getInfo().name},page:1,pageSize:10,total:0,loading:!1}},computed:{client:function(){return location.href.includes("classic")||location.href.includes("origin")?"origin":"std"}},methods:{get_comments:function(){var t=this;function e(t,i){var s=[],a=function(){var a=t[n];if(!a)return"continue";if(a.parent_id===i){var r=e(a.children,a.id);a.children=r.map((function(t){return t.parent={user_id:a.user_id,user_nickname:a.user_nickname,id:a.id},t.reply_form={show:!1,content:"",user_nickname:S["a"].getInfo().name},t})),s.push(a)}};for(var n in t)a();return s}this.type&&this.sourceId&&(this.loading=!0,_["b"].list({type:this.type,id:this.sourceId},{client:this.client,page:this.page}).then((function(i){if(i=i.data,200===i.code){for(var s=i.data.comments,a=0;a<s.length;a++)s[a]["reply_form"]={show:!1,content:"",user_nickname:S["a"].getInfo().name};t.page=i.data.current_page,t.total=i.data.total,t.comments=e(s,0),t.loading=!1}}),(function(){t.comments=!1,t.loading=!1})))},create_comment:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t.content){var s={comment:{type:this.type,source_id:this.sourceId,parent_id:i,user_nickname:t.user_nickname||S["a"].getInfo().name,content:t.content},client:this.client};_["b"].post({data:s},{}).then((function(i){i=i.data,200===i.code?(t.content="",e.$message({message:"提交成功，请等待审核",type:"success"})):e.$message({message:"".concat(i.message),type:"warning"})}),(function(){e.$message({message:"网络异常，提交失败",type:"warning"})})).finally((function(){t.show=!1}))}else this.$message({message:"请先填写评论内容再尝试提交",type:"warning"})},handleCurrentChange:function(t){this.page=t,this.get_comments()}},components:{WikiPanel:g["a"],Comment:N},watch:{sourceId:{immediate:!0,handler:function(){this.get_comments()}}}},L=A,D=(i("8c22"),Object(m["a"])(L,y,C,!1,null,null,null)),T=D.exports,$={name:"Single",inject:["__imgRoot"],components:{SameList:p,WikiPanel:g["a"],WikiRevisions:h["a"],WikiComments:T,Article:f["a"]},data:function(){return{loading:!1,sameLoading:!1,item:{},sameList:[],wiki_post:{source:{},post:null},compatible:!1,is_empty:!0}},computed:{id:function(){return this.$route.params.id},type:function(){return this.$route.params.type},client:function(){return this.$store.state.client},basicAttrs:function(){var t=this.item.MagicAttributes;return t&&t.length?t.filter((function(t){return!t.icon})):[]},magicAttrs:function(){var t=this.item.MagicAttributes;return t&&t.length?t.filter((function(t){return t.icon})).map((function(t){return t.iconUrl=Object(r["iconLink"])(t.icon),t})):[]},typeName:function(){var t=this.item,e="";return 15===t.SubType?e=0===t.DetailType?"普通坐骑":"奇趣坐骑":23===t.SubType&&(e=0===t.DetailType?"头饰":1===t.DetailType?"鞍饰":2===t.DetailType?"足饰":3===t.DetailType?"马饰":"马具"),e},modeName:function(){var t="",e=this.item;return 15===e.SubType&&e.MagicAttributes&&e.MagicAttributes.length&&(t=e.MagicAttributes.find((function(t){return"15650"===t.id}))?e.MagicAttributes.find((function(t){return"15650"===t.id})).name:"单骑"),t},feedName:function(){var t=this.item,e="";if(15===t.SubType&&t.Feed){var i=t.Feed.FeedTip.indexOf("【"),s=t.Feed.FeedTip.indexOf("】");e=t.Feed.FeedTip.slice(i,s+1)}return e},speedName:function(){var t=this.item,e="";return t.MoveSpeed&&(e=t.MoveSpeedDesc.split("移动速度提高")[1]),e},post_id:function(){return this.$route.params.post_id},isRevision:function(){return!!this.$route.params.post_id},author_id:function(){var t,e;return~~(null===(t=this.wiki_post)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.user_id)},user_name:function(){var t,e;return null===(t=this.wiki_post)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.user_nickname},updated_at:function(){var t,e;return Object(r["ts2str"])(null===(t=this.wiki_post)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.updated)},fav_title:function(){var t,e;return null===(t=this.wiki_post)||void 0===t||null===(e=t.source)||void 0===e?void 0:e.Name},authors:function(){var t,e,i;return this.isRevision?[]:(null===(t=this.wiki_post)||void 0===t||null===(e=t.users)||void 0===e||null===(i=e.filter((function(t){return t.id})))||void 0===i?void 0:i.map((function(t){return{user_id:t.id,user_avatar:t.avatar,display_name:t.nickname}})))||[]}},watch:{id:{handler:function(){this.loadData()}},post_id:{handler:function(){this.loadRevision()}}},methods:{goBack:function(){this.$router.push({name:"list"})},getHorse:function(){var t=this,e={id:this.id,client:this.client};"2"===this.type&&(e.type=2),this.loading=!0,Object(n["c"])(e).then((function(e){t.loading=!1,t.item=e.data||{};var i=e.data.Name;"普通坐骑"===t.typeName&&(i=e.data.Name.split("·")[0]),"2"!==t.type&&i&&t.getSameHorses(i)})).catch((function(){t.loading=!1})).finally((function(){t.loading=!1}))},getSameHorses:function(t){var e=this,i={page:1,pageSize:50,client:this.client,keyword:t};this.sameLoading=!0,Object(n["d"])(i).then((function(t){e.sameLoading=!1,e.sameList=t.data.list.filter((function(t){return t.ID!==e.item.ID})).map((function(t){return t.imgUrl=e.getImgSrc(t.ImgPath),t.MagicAttributes&&t.MagicAttributes.length&&t.MagicAttributes.map((function(t){return t.iconUrl=Object(r["iconLink"])(t.icon),t})),t}))})).catch((function(){e.sameLoading=!1}))},getImgSrc:function(t){if(t){var e=t.toLowerCase().match(/.*[\/,\\]homeland(.*?).tga/),i=e[1].replace(/\\/g,"/");return"default"==e[1]?this.__imgRoot+"homeland/".concat(this.client)+"/default/default.png":this.__imgRoot+"homeland/".concat(this.client)+i+".png"}},getLink:r["getLink"],publish_url:r["publishLink"],loadData:function(){var t=this;this.id&&_["a"].mix({type:"item",id:this.id,client:this.client},{supply:1}).then((function(e){var i=e.post,s=e.source,a=e.compatible,n=e.isEmpty,r=e.users;t.wiki_post={post:i,source:s,users:r},t.is_empty=n,t.compatible=a})),this.triggerStat()},loadRevision:function(){var t=this;_["a"].getById(this.post_id,{type:"item"}).then((function(e){var i;t.wiki_post=null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.data})),this.triggerStat()},triggerStat:function(){"origin"==this.client?Object(v["b"])("origin_item",this.id):Object(v["b"])("item",this.id)}},mounted:function(){this.getHorse(),this.post_id?this.loadRevision():this.loadData()}},j=$,O=(i("24b5"),Object(m["a"])(j,s,a,!1,null,null,null));e["default"]=O.exports},"8c22":function(t,e,i){"use strict";i("ac04")},"8cbd":function(t,e,i){},"8ecf":function(t,e,i){"use strict";i("8cbd")},ac04:function(t,e,i){},f252:function(t,e,i){"use strict";i.d(e,"d",(function(){return n})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return c}));var s=i("41cb"),a=(i("65c2"),i("bc3a"),Object(s["e"])());function n(t){return a.get("/horses",{params:t})}function r(t){return a.get("/horse",{params:t})}function o(t){return a.get("/horse/attrs",{params:t})}function c(t){return a.get("/horse/feeds ",{params:t})}}}]);
//# sourceMappingURL=chunk-3a323672.6131606a.js.map