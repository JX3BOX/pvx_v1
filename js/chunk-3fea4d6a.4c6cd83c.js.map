{"version":3,"sources":["webpack:///./src/components/gonggao/calendar/Single.vue","webpack:///src/components/gonggao/calendar/Single.vue","webpack:///./src/components/gonggao/calendar/Single.vue?9db9","webpack:///./src/components/gonggao/calendar/Single.vue?f39e","webpack:///./src/components/gonggao/calendar/Single.vue?c75f"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","goBack","_v","isEditor","$event","manage","isCreator","_e","directives","name","rawName","value","todayLoading","expression","class","today","type","_s","client","desc","user_info","showAvatar","user_avatar","authorLink","user_id","display_name","showTime","created_at","_m","references","length","_l","reference","index","key","url","label","historyLoading","timelineKeys","String","timelineData","item","id","favTitle","author","dateObj","isSuper","model","visible","callback","$$v","staticRenderFns","components","Comment","CalendarDialog","CalendarDetailItem","data","history","computed","$route","params","_ref","month","date","year","arr","_this$today","link","link_temp","cloneDeep","some","push","_this$history","reduce","acc","obj","Object","keys","map","parseInt","sort","a","b","User","getInfo","uid","_this$today$desc","slice","watch","immediate","handler","val","loadData","deep","loadHistory","methods","_this","getDetail","then","res","finally","postStat","_this2","getHistory","reverse","back","$router","concat","formatDate","_ref2","component"],"mappings":"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","file":"js/chunk-3fea4d6a.4c6cd83c.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-calendar-single\"},[_c('section',{staticClass:\"m-actions\"},[_c('el-button',{attrs:{\"icon\":\"el-icon-arrow-left\",\"size\":\"small\"},on:{\"click\":_vm.goBack}},[_vm._v(\"返回\")]),(_vm.isEditor)?_c('el-button',{attrs:{\"icon\":\"el-icon-setting\",\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.manage(true)}}},[_vm._v(\" 管理 \")]):(_vm.isCreator)?_c('el-button',{attrs:{\"icon\":\"el-icon-edit\",\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.manage(false)}}},[_vm._v(\" 编辑 \")]):_vm._e()],1),_c('section',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.todayLoading),expression:\"todayLoading\"}],staticClass:\"m-single-block m-today\"},[_c('header',{staticClass:\"m-single-title m-history-header\"},[_c('i',{class:_vm.today.type == 1 ? 'el-icon-collection-tag' : 'el-icon-s-flag'}),_vm._v(_vm._s(_vm.today.type == 1 ? \"事件\" : \"活动\")+\"记录 \")]),_c('div',{staticClass:\"m-today-content\"},[_c('i',{staticClass:\"u-client\",class:_vm.today.client},[_vm._v(_vm._s(_vm.today.client == \"std\" ? \"正式服\" : \"怀旧服\"))]),_vm._v(_vm._s(_vm.today.desc)+\" \")]),(_vm.today && _vm.today.user_info)?_c('div',{staticClass:\"m-today-meta\"},[_c('span',{staticClass:\"u-user\"},[_c('img',{attrs:{\"src\":_vm.showAvatar(_vm.today.user_info.user_avatar),\"width\":\"24\",\"height\":\"24\",\"alt\":\"\"}}),_c('a',{attrs:{\"href\":_vm.authorLink(_vm.today.user_id),\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.today.user_info.display_name))])]),_c('span',{staticClass:\"u-create-time\",attrs:{\"title\":\"创建时间\"}},[_c('i',{staticClass:\"el-icon-date\"}),_c('time',[_vm._v(_vm._s(_vm.showTime(_vm.today.created_at)))])])]):_vm._e()]),_c('div',{staticClass:\"m-single-block m-reference\"},[_vm._m(0),(_vm.references && _vm.references.length)?_vm._l((_vm.references),function(reference,index){return _c('div',{key:index,staticClass:\"m-reference-item\"},[(reference.url)?_c('a',{staticClass:\"u-item u-link\",attrs:{\"href\":reference.url,\"target\":\"_blank\"}},[_c('label',{staticClass:\"u-index\"},[_vm._v(_vm._s(index + 1)+\".\")]),_c('span',{staticClass:\"u-label\"},[_vm._v(_vm._s(reference.label)+\" \"),_c('i',{staticClass:\"el-icon-link\"})])]):_c('span',{staticClass:\"u-item\"},[_c('label',{staticClass:\"u-index\"},[_vm._v(_vm._s(index + 1)+\".\")]),_c('span',{staticClass:\"u-label\"},[_vm._v(_vm._s(reference.label))])])])}):_c('div',{staticClass:\"u-null\"},[_c('i',{staticClass:\"el-icon-warning-outline\"}),_vm._v(\"暂时没有任何参考资料\")])],2),_c('section',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.historyLoading),expression:\"historyLoading\"}],staticClass:\"m-single-block m-history\"},[_vm._m(1),_c('div',{staticClass:\"m-history-content\"},[_c('el-timeline',_vm._l((_vm.timelineKeys),function(key){return _c('el-timeline-item',{key:key,attrs:{\"timestamp\":String(key),\"placement\":\"top\"}},_vm._l((_vm.timelineData[key]),function(item){return _c('div',{key:item.id,staticClass:\"m-history-item\"},[_c('calendar-detail-item',{attrs:{\"type\":item.type,\"data\":item}})],1)}),0)}),1)],1)]),_c('Thx',{attrs:{\"postId\":_vm.id,\"postType\":\"calendar\",\"postTitle\":_vm.favTitle,\"userId\":_vm.author,\"adminBoxcoinEnable\":true,\"userBoxcoinEnable\":true}}),_c('Comment',{staticClass:\"m-comment\",attrs:{\"id\":_vm.id,\"category\":\"calendar\"}}),_c('calendar-dialog',{attrs:{\"date-obj\":_vm.dateObj,\"selected\":_vm.today,\"mode\":\"update\",\"isSuper\":_vm.isSuper},model:{value:(_vm.visible),callback:function ($$v) {_vm.visible=$$v},expression:\"visible\"}})],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('header',{staticClass:\"m-single-title m-history-header\"},[_c('i',{staticClass:\"el-icon-connection\"}),_vm._v(\"参考资料\")])\n},function (){var _vm=this,_c=_vm._self._c;return _c('header',{staticClass:\"m-single-title m-history-header\"},[_c('i',{staticClass:\"el-icon-date\"}),_vm._v(\"那年今日\")])\n}]\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"m-calendar-single\">\n        <section class=\"m-actions\">\n            <el-button icon=\"el-icon-arrow-left\" @click=\"goBack\" size=\"small\">返回</el-button>\n            <el-button icon=\"el-icon-setting\" type=\"primary\" size=\"small\" @click=\"manage(true)\" v-if=\"isEditor\">\n                管理\n            </el-button>\n            <el-button icon=\"el-icon-edit\" type=\"primary\" size=\"small\" @click=\"manage(false)\" v-else-if=\"isCreator\">\n                编辑\n            </el-button>\n        </section>\n        <section class=\"m-single-block m-today\" v-loading=\"todayLoading\">\n            <header class=\"m-single-title m-history-header\">\n                <i :class=\"today.type == 1 ? 'el-icon-collection-tag' : 'el-icon-s-flag'\"></i\n                >{{ today.type == 1 ? \"事件\" : \"活动\" }}记录\n            </header>\n            <div class=\"m-today-content\">\n                <i class=\"u-client\" :class=\"today.client\">{{ today.client == \"std\" ? \"正式服\" : \"怀旧服\" }}</i\n                >{{ today.desc }}\n            </div>\n            <div class=\"m-today-meta\" v-if=\"today && today.user_info\">\n                <span class=\"u-user\">\n                    <img :src=\"showAvatar(today.user_info.user_avatar)\" width=\"24\" height=\"24\" alt=\"\" />\n                    <a :href=\"authorLink(today.user_id)\" target=\"_blank\">{{ today.user_info.display_name }}</a>\n                </span>\n                <span class=\"u-create-time\" title=\"创建时间\">\n                    <i class=\"el-icon-date\"></i>\n                    <time>{{ showTime(today.created_at) }}</time>\n                </span>\n            </div>\n        </section>\n\n        <div class=\"m-single-block m-reference\">\n            <header class=\"m-single-title m-history-header\"><i class=\"el-icon-connection\"></i>参考资料</header>\n            <template v-if=\"references && references.length\">\n                <div class=\"m-reference-item\" v-for=\"(reference, index) in references\" :key=\"index\">\n                    <a class=\"u-item u-link\" :href=\"reference.url\" target=\"_blank\" v-if=\"reference.url\">\n                        <label class=\"u-index\">{{ index + 1 }}.</label>\n                        <span class=\"u-label\">{{ reference.label }} <i class=\"el-icon-link\"></i></span>\n                    </a>\n                    <span class=\"u-item\" v-else>\n                        <label class=\"u-index\">{{ index + 1 }}.</label>\n                        <span class=\"u-label\">{{ reference.label }}</span>\n                    </span>\n                </div>\n            </template>\n            <div v-else class=\"u-null\"><i class=\"el-icon-warning-outline\"></i>暂时没有任何参考资料</div>\n        </div>\n\n        <section class=\"m-single-block m-history\" v-loading=\"historyLoading\">\n            <header class=\"m-single-title m-history-header\"><i class=\"el-icon-date\"></i>那年今日</header>\n            <div class=\"m-history-content\">\n                <el-timeline>\n                    <el-timeline-item v-for=\"key in timelineKeys\" :key=\"key\" :timestamp=\"String(key)\" placement=\"top\">\n                        <div class=\"m-history-item\" v-for=\"item in timelineData[key]\" :key=\"item.id\">\n                            <calendar-detail-item :type=\"item.type\" :data=\"item\"></calendar-detail-item>\n                        </div>\n                    </el-timeline-item>\n                </el-timeline>\n            </div>\n        </section>\n\n        <Thx\n            :postId=\"id\"\n            postType=\"calendar\"\n            :postTitle=\"favTitle\"\n            :userId=\"author\"\n            :adminBoxcoinEnable=\"true\"\n            :userBoxcoinEnable=\"true\"\n        />\n\n        <Comment class=\"m-comment\" :id=\"id\" category=\"calendar\" />\n\n        <calendar-dialog\n            v-model=\"visible\"\n            :date-obj=\"dateObj\"\n            :selected=\"today\"\n            mode=\"update\"\n            :isSuper=\"isSuper\"\n        ></calendar-dialog>\n    </div>\n</template>\n\n<script>\nimport { getDetail, getHistory } from \"@/service/calendar.js\";\nimport { postStat } from \"@jx3box/jx3box-common/js/stat\";\nimport { showAvatar, authorLink } from \"@jx3box/jx3box-common/js/utils\";\nimport { showTime } from \"@jx3box/jx3box-common/js/moment\";\nimport cloneDeep from \"lodash/cloneDeep\";\nimport User from \"@jx3box/jx3box-common/js/user.js\";\n\nimport Comment from \"@jx3box/jx3box-comment-ui/src/Comment.vue\";\nimport CalendarDialog from \"@/components/gonggao/calendar/CalendarDialog\";\nimport CalendarDetailItem from \"@/components/gonggao/calendar/CalendarDetailItem.vue\";\nexport default {\n    name: \"SingleCalendar\",\n    components: {\n        Comment,\n        CalendarDialog,\n        CalendarDetailItem,\n    },\n    data() {\n        return {\n            today: \"\",\n            history: [],\n            todayLoading: false,\n            historyLoading: false,\n\n            // 弹窗\n            visible: false,\n            isSuper: false,\n        };\n    },\n    computed: {\n        id() {\n            return ~~this.$route.params.id;\n        },\n        author() {\n            return this.today.user_id;\n        },\n        params({ today }) {\n            return today\n                ? {\n                      month: today.month,\n                      date: today.date,\n                  }\n                : \"\";\n        },\n        dateObj() {\n            return {\n                year: this.today.year,\n                month: this.today.month,\n                date: this.today.date,\n            };\n        },\n        references() {\n            let arr = [];\n            const { link, link_temp } = this.today;\n\n            link && link.length && (arr = cloneDeep(link));\n\n            if (link_temp && !arr.some((item) => item.url === link_temp)) {\n                arr.push({\n                    label: \"官方新闻\",\n                    url: link_temp,\n                });\n            }\n            return arr;\n        },\n        timelineData() {\n            let history;\n            // 将同一年份的记录归档至同一数组内\n            history = this.history?.reduce((acc, obj) => {\n                const key = obj.year;\n                if (!acc[key]) {\n                    acc[key] = [];\n                }\n                acc[key].push(obj);\n\n                return acc;\n            }, {});\n\n            return history;\n        },\n        timelineKeys() {\n            // 倒序历史记录年份 大 -> 小\n            return Object.keys(this.timelineData || {})\n                .map((year) => parseInt(year, 10))\n                .sort((a, b) => b - a);\n        },\n        isEditor() {\n            return User.isEditor();\n        },\n        isCreator() {\n            return this.today.user_id == User.getInfo().uid;\n        },\n        favTitle() {\n            return this.today.desc?.slice(0, 20) + \"...\";\n        },\n    },\n    watch: {\n        id: {\n            immediate: true,\n            handler(val) {\n                if (val) {\n                    this.loadData();\n                }\n            },\n        },\n        params: {\n            deep: true,\n            handler(val) {\n                if (val) {\n                    this.loadHistory(val);\n                }\n            },\n        },\n    },\n    methods: {\n        // ====== 数据获取 ==========\n        loadData() {\n            this.todayLoading = true;\n            getDetail(this.id)\n                .then((res) => {\n                    this.today = res.data.data;\n                })\n                .finally(() => {\n                    postStat(\"calendar\", this.id);\n                    this.todayLoading = false;\n                });\n        },\n        loadHistory(params) {\n            this.historyLoading = true;\n            getHistory(params)\n                .then((res) => {\n                    this.history = (res.data.data || []).reverse();\n                })\n                .finally(() => {\n                    this.historyLoading = false;\n                });\n        },\n\n        // ========= other ==========\n        goBack() {\n            // 如果存在历史则返回上一个记录，否则返回月历页面\n            history.length > 1\n                ? history.back()\n                : this.$router.push(`/archive/${this.dateObj.year}/${this.dateObj.month}`);\n        },\n        manage(isSuper) {\n            this.visible = true;\n            this.isSuper = isSuper;\n        },\n\n        // ========= filters =========\n        formatDate({ year, month, date }) {\n            return `${month}月${date}日`;\n        },\n        showAvatar(val) {\n            return showAvatar(val, 24);\n        },\n        authorLink,\n        showTime,\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"~@/assets/css/calendar/single.less\";\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Single.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Single.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Single.vue?vue&type=template&id=3299956a\"\nimport script from \"./Single.vue?vue&type=script&lang=js\"\nexport * from \"./Single.vue?vue&type=script&lang=js\"\nimport style0 from \"./Single.vue?vue&type=style&index=0&id=3299956a&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Single.vue?vue&type=style&index=0&id=3299956a&prod&lang=less\""],"sourceRoot":""}