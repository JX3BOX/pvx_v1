(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f7dfcc2"],{"1c59":function(t,e,n){"use strict";var i=n("6d61"),s=n("6566");i("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),s)},"498b":function(t,e,n){},"4fadd":function(t,e,n){var i=n("d039"),s=n("861d"),a=n("c6b6"),r=n("d86b"),o=Object.isExtensible,c=i((function(){o(1)}));t.exports=c||r?function(t){return!!s(t)&&((!r||"ArrayBuffer"!=a(t))&&(!o||o(t)))}:o},"5e17":function(t,e,n){"use strict";n("ab6c")},6062:function(t,e,n){n("1c59")},"60d7":function(t){t.exports=JSON.parse('["蝶恋花","龙争虎斗","长安城","幽月轮","斗转星移","剑胆琴心","乾坤一掷","唯我独尊","梦江南","横刀断浪","绝代天骄","天鹅坪","破阵子","飞龙在天","青梅煮酒"]')},6566:function(t,e,n){"use strict";var i=n("7c73"),s=n("edd0"),a=n("6964"),r=n("0366"),o=n("19aa"),c=n("7234"),l=n("2266"),u=n("c6d2"),d=n("4754"),m=n("2626"),p=n("83ab"),f=n("f183").fastKey,v=n("69f3"),h=v.set,_=v.getterFor;t.exports={getConstructor:function(t,e,n,u){var d=t((function(t,s){o(t,m),h(t,{type:e,index:i(null),first:void 0,last:void 0,size:0}),p||(t.size=0),c(s)||l(s,t[u],{that:t,AS_ENTRIES:n})})),m=d.prototype,v=_(e),g=function(t,e,n){var i,s,a=v(t),r=b(t,e);return r?r.value=n:(a.last=r={index:s=f(e,!0),key:e,value:n,previous:i=a.last,next:void 0,removed:!1},a.first||(a.first=r),i&&(i.next=r),p?a.size++:t.size++,"F"!==s&&(a.index[s]=r)),t},b=function(t,e){var n,i=v(t),s=f(e);if("F"!==s)return i.index[s];for(n=i.first;n;n=n.next)if(n.key==e)return n};return a(m,{clear:function(){var t=this,e=v(t),n=e.index,i=e.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete n[i.index],i=i.next;e.first=e.last=void 0,p?e.size=0:t.size=0},delete:function(t){var e=this,n=v(e),i=b(e,t);if(i){var s=i.next,a=i.previous;delete n.index[i.index],i.removed=!0,a&&(a.next=s),s&&(s.previous=a),n.first==i&&(n.first=s),n.last==i&&(n.last=a),p?n.size--:e.size--}return!!i},forEach:function(t){var e,n=v(this),i=r(t,arguments.length>1?arguments[1]:void 0);while(e=e?e.next:n.first){i(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!b(this,t)}}),a(m,n?{get:function(t){var e=b(this,t);return e&&e.value},set:function(t,e){return g(this,0===t?0:t,e)}}:{add:function(t){return g(this,t=0===t?0:t,t)}}),p&&s(m,"size",{configurable:!0,get:function(){return v(this).size}}),d},setStrong:function(t,e,n){var i=e+" Iterator",s=_(e),a=_(i);u(t,e,(function(t,e){h(this,{type:i,target:t,state:s(t),kind:e,last:void 0})}),(function(){var t=a(this),e=t.kind,n=t.last;while(n&&n.removed)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?d("keys"==e?n.key:"values"==e?n.value:[n.key,n.value],!1):(t.target=void 0,d(void 0,!0))}),n?"entries":"values",!n,!0),m(e)}}},"69ba":function(t,e,n){"use strict";n("8491")},"6d61":function(t,e,n){"use strict";var i=n("23e7"),s=n("da84"),a=n("e330"),r=n("94ca"),o=n("cb2d"),c=n("f183"),l=n("2266"),u=n("19aa"),d=n("1626"),m=n("7234"),p=n("861d"),f=n("d039"),v=n("1c7e"),h=n("d44e"),_=n("7156");t.exports=function(t,e,n){var g=-1!==t.indexOf("Map"),b=-1!==t.indexOf("Weak"),y=g?"set":"add",k=s[t],C=k&&k.prototype,w=k,x={},A=function(t){var e=a(C[t]);o(C,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(b&&!p(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return b&&!p(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(b&&!p(t))&&e(this,0===t?0:t)}:function(t,n){return e(this,0===t?0:t,n),this})},Y=r(t,!d(k)||!(b||C.forEach&&!f((function(){(new k).entries().next()}))));if(Y)w=n.getConstructor(e,t,g,y),c.enable();else if(r(t,!0)){var D=new w,j=D[y](b?{}:-0,1)!=D,S=f((function(){D.has(1)})),O=v((function(t){new k(t)})),P=!b&&f((function(){var t=new k,e=5;while(e--)t[y](e,e);return!t.has(-0)}));O||(w=e((function(t,e){u(t,C);var n=_(new k,t,w);return m(e)||l(e,n[y],{that:n,AS_ENTRIES:g}),n})),w.prototype=C,C.constructor=w),(S||P)&&(A("delete"),A("has"),g&&A("get")),(P||j)&&A(y),b&&C.clear&&delete C.clear}return x[t]=w,i({global:!0,constructor:!0,forced:w!=k},x),h(w,t),b||n.setStrong(w,t,g),w}},8491:function(t,e,n){},"85b5":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t._self._c;return t.id?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"p-adventure-single"},[e("div",{staticClass:"m-adventure-navigation"},[e("el-button",{staticClass:"u-goback",attrs:{size:"medium",plain:""},on:{click:t.goBack}},[t._v("返回列表")])],1),e("div",{staticClass:"m-adventure-header"},[e("span",{staticClass:"m-adventure-title"},[t._v(t._s(t.title))]),e("div",{staticClass:"m-trigger-links"},[e("a",{staticClass:"u-link u-achievement",attrs:{href:t.getLink("cj",t.achieve_id),target:"_blank"}},[e("i",{staticClass:"el-icon-trophy"}),t._v(" 成就信息 ")])])]),e("div",{staticClass:"m-adventure-content"},[e("task",{attrs:{id:t.id,info:t.data}})],1),t.achieve_id?e("div",{staticClass:"m-adventure-wiki"},[e("Wiki",{attrs:{source_type:"achievement",source_id:t.achieve_id,type:t.type,id:t.id,title:"奇遇攻略",source_title:t.title}})],1):t._e(),e("div",{staticClass:"m-adventure-serendipity"},[e("Serendipity",{attrs:{title:t.title}})],1),e("WikiComments",{attrs:{type:t.type,"source-id":t.id}})],1):t._e()},s=[],a=(n("14d9"),n("d3b7"),n("ac1f"),n("841c"),n("85e4")),r=n("bd8e"),o=n("bed2"),c=function(){var t=this,e=t._self._c;return t.task?e("div",{staticClass:"m-adventure-task"},[e("img",{staticClass:"u-prefix",attrs:{src:n("bb64")}}),e("img",{staticClass:"u-suffix",attrs:{src:n("bb64")}}),e("div",{staticClass:"u-content",attrs:{id:"task-box"}},[e("div",{staticClass:"u-item u-task-name"},[e("img",{attrs:{src:t.getImg()}}),e("div",{staticClass:"u-info-box"},[e("span",{staticClass:"u-title"},[t._v(t._s(t.info.szName))])])]),t._l(t.task,(function(n,i){return e("div",{key:i,staticClass:"u-item"},[e("img",{attrs:{src:t.imgUrl(n.imgurl)}}),e("div",{staticClass:"u-info-box u-desc-box"},[e("div",{staticClass:"u-title"},[t._v(t._s(n.szGoalMsg))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.getText(n.szDescribe)))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.getText(n.szFinishDescribe)))])])])}))],2),e("div",{staticClass:"u-btn"},[e("span",{class:t.isDisabled("task-box",1,t.isUpdate),on:{click:function(e){return t.crosswiseScrool(e,"task-box",1,600)}}},[e("i",{staticClass:"el-icon-arrow-left"})]),e("span",{class:t.isDisabled("task-box",-1,t.isUpdate),on:{click:function(e){return t.crosswiseScrool(e,"task-box",-1,600)}}},[t._v("继续 "),e("i",{staticClass:"el-icon-arrow-right"})])])]):t._e()},l=[],u=n("2909"),d=(n("466d"),n("99af"),n("5319"),n("159b"),n("6062"),n("3ca3"),n("ddb0"),n("ed08")),m={name:"task",props:["id","info"],inject:["__imgRoot"],components:{},data:function(){return{task:[],isUpdate:!1}},computed:{client:function(){return this.$store.state.client}},methods:{imgNameTga:function(t){return t.match(/(\S*)Adventure\/(\S*)\.tga/)[2]},imgUrl:function(t){return this.__imgRoot+"adventure/".concat(this.client,"/").concat(t,".png")},getImg:function(){var t,e=(null===(t=this.info.szOpenRewardPath)||void 0===t?void 0:t.toLowerCase().match(/.*[\/,\\]adventure(.*?).tga/))||"",n="";return e[1]&&(n=e[1].replace(/\\/g,"/")),this.imgUrl(n)},getText:function(t){var e=Object(a["extractTextContent"])(t),n="";return e.forEach((function(t){n+=t.text})),n},loadData:function(){var t=this;Object(o["b"])(this.id).then((function(e){var n=[];e.data.forEach((function(e){if(e.szFramePath){var i,s=null===(i=e.szFramePath)||void 0===i?void 0:i.replace(/\\/g,"/");e.imgurl=t.imgNameTga(s),n.push(e)}})),t.task=Object(u["a"])(new Set(n))}))},isDisabled:function(t,e){var n=document.getElementById(t);if(n)return 0==n.scrollLeft&&1==e||0!=n.scrollLeft&&n.scrollWidth<=n.scrollLeft+n.clientWidth&&-1==e?"u-disabled":""},crosswiseScrool:function(t,e,n,i){if(!Object(d["b"])()){t.preventDefault();var s=document.getElementById(e),a=s.scrollWidth;if((0!=s.scrollLeft||1!=n)&&!(a<=s.scrollLeft+s.clientWidth&&-1==n)){var r=(i||200)/100,o=0,c=this;l()}}function l(){o+=r,o<i?(1==n?s.scrollLeft-=r:s.scrollLeft+=r,setTimeout(l,1)):c.isUpdate=!c.isUpdate}}},filters:{},created:function(){},mounted:function(){this.loadData()}},p=m,f=n("2877"),v=Object(f["a"])(p,c,l,!1,null,null,null),h=v.exports,_=(n("b0c0"),function(){var t=this,e=t._self._c;return t.title?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-serendipity"},[e("div",{staticClass:"u-title"},[e("span",{staticClass:"u-label"},[e("i",{staticClass:"el-icon-present"}),t._v(" 触发记录 "),e("el-select",{staticClass:"u-server",attrs:{placeholder:"区服",size:"small"},on:{change:t.changeServer},model:{value:t.server,callback:function(e){t.server=e},expression:"server"}},t._l(t.servers,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),e("a",{staticClass:"u-more",attrs:{href:"https://j3cx.com/serendipity",target:"_blank"}},[t._v("查看更多 »")])]),t.list&&t.list.length>0?e("ul",{staticClass:"u-list"},[t._m(0),t._l(t.list,(function(n,i){return e("li",{key:i},[e("span",{staticClass:"u-date"},[t._v(t._s(t._f("showDate")(n.date_str)))]),e("span",{staticClass:"u-time"},[t._v(t._s(t._f("wikiDate")(n.dwTime)))]),e("span",{staticClass:"u-server"},[t._v(t._s(n.region)+"-"+t._s(n.server))]),e("span",{staticClass:"u-name"},[t._v(t._s(n.name||"匿名"))])])}))],2):e("el-alert",{staticClass:"u-alert",attrs:{title:"无记录",type:"info",center:"",closable:!1}})],1):t._e()}),g=[function(){var t=this,e=t._self._c;return e("li",{staticClass:"u-header"},[e("span",{staticClass:"u-date"},[t._v("日期")]),e("span",{staticClass:"u-time"},[t._v("激活时间")]),e("span",{staticClass:"u-server"},[t._v("服务器")]),e("span",{staticClass:"u-name"},[t._v("玩家")])])}],b=n("60d7"),y=n("41cb");function k(){return Object(y["a"])().get("/api/cms/user/my/info")}function C(t){var e="https://pull.j3cx.com/";return y["h"].get("/api/serendipity",{baseURL:e,params:t})}var w=n("8f09"),x=n("c9d2"),A={name:"serendipity",props:["title"],components:{},data:function(){return{servers:b,server:"长安城",list:[],loading:!1}},computed:{params:function(){return{server:this.server,serendipity:this.title,start:0,pageIndex:1,pageSize:10}}},methods:{loadSerendipity:function(){var t=this;this.loading=!0,C(this.params).then((function(e){t.list=e.data.data.data})).finally((function(){t.loading=!1}))},changeServer:function(){this.loadSerendipity()}},filters:{wikiDate:function(t){return Object(w["b"])(1e3*t)},showDate:function(t){return Object(w["a"])(t)}},mounted:function(){var t=this;x["a"].isLogin()?k().then((function(e){t.server=e.data.data.jx3_server||"长安城"})).then((function(){t.loadSerendipity()})):this.loadSerendipity()}},Y=A,D=(n("ef52"),Object(f["a"])(Y,_,g,!1,null,null,null)),j=D.exports,S=(n("23d8"),n("9616")),O=n("d825"),P={name:"adventureSingle",props:[],components:{Wiki:r["a"],task:h,Serendipity:j,WikiComments:O["a"]},data:function(){return{type:"adventure",achieve_id:"",data:"",task:[],isPet:!0,loading:!1,search:""}},computed:{id:function(){return this.$route.params.id},title:function(){var t;return null===(t=this.data)||void 0===t?void 0:t.szName}},watch:{id:{immediate:!0,handler:function(t){t&&this.getData()}}},methods:{getLink:a["getLink"],goBack:function(){this.$router.push({name:"list"})},getData:function(){var t=this;this.loading=!0,Object(o["a"])(this.id).then((function(e){t.isPet=!1,t.data=e.data})).finally((function(){t.loading=!1,Object(S["b"])(t.type,t.id)})),Object(o["d"])(this.id).then((function(e){t.achieve_id=e.data.achievement_id}))},goSearch:function(){this.$router.push({name:"list",params:{search:this.search}})}},mounted:function(){}},M=P,L=(n("5e17"),Object(f["a"])(M,i,s,!1,null,null,null));e["default"]=L.exports},"8c22":function(t,e,n){"use strict";n("ac04")},"8f09":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return o}));var i=n("c1df"),s=n.n(i);function a(t){return s()(t).fromNow()}function r(t){return s()(t).format("YYYY-MM-DD")}function o(t){return s()(t).format("YYYY-MM-DD HH:mm:ss")}s.a.locale("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY-MM-DD",LL:"YYYY年MM月DD日",LLL:"YYYY年MM月DD日Ah点mm分",LLLL:"YYYY年MM月DD日ddddAh点mm分",l:"YYYY-M-D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(t,e){return 12===t&&(t=0),"凌晨"===e||"早上"===e||"上午"===e?t:"下午"===e||"晚上"===e?t+12:t>=11?t:t+12},meridiem:function(t,e,n){var i=100*t+e;return i<600?"凌晨":i<900?"早上":i<1130?"上午":i<1230?"中午":i<1800?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:"[下]ddddLT",lastDay:"[昨天]LT",lastWeek:"[上]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(日|月|周)/,ordinal:function(t,e){switch(e){case"d":case"D":case"DDD":return t+"日";case"M":return t+"月";case"w":case"W":return t+"周";default:return t}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",ss:"%d秒",m:"1分钟",mm:"%d分钟",h:"1小时",hh:"%d小时",d:"1天",dd:"%d天",M:"1个月",MM:"%d个月",y:"1年",yy:"%d年"},week:{dow:1,doy:4}})},ab6c:function(t,e,n){},ac04:function(t,e,n){},bb2f:function(t,e,n){var i=n("d039");t.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bb64:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAFeCAYAAACFPT+zAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJqSURBVHgB7Z3dSisxFIX3zimHc1nhPMC5Pk/hI/kGfU1BRLwQQShaxJ/SmjgzTm3V8cJmFXdda4GYqfFrMsk02dk7qRlQi8XdJBlUybDAnMHAhC6hoUtoZsEbBV7ljK5ysvCNYnT3UK0cEEjYbUzAcMCMHlMSfNTbg46d0Y1i6EYxthKuoDDBq2xG18rGByRslB1UOb6tF994jD7qtZIVUClZAQzAXbSy30xPz0p/7c1Pm/bXRP+H8nI5lKds8Nx9PCppfmjr/1v/9s2c6+SneRr9/vX3aHRw8P/cQJrPZzd6luuJbEume1BCTThR0LhAmWYA7YGTS/ewmmfxrVF1m2rJJ1Wv8DPYjO42Kf4ntgxwAQMAd+AopJtj432jRreoS+h5JARmxSzVK755G346B59wtiJbc8Ab4PGNR/n1AgJ1DymA2heAUPQqE3YbAQX8smQv1wvvbOUzfHZSwtHDw+U/e2yu/vSvrtJDr9kn172eFk9jn14dn60Cm4bkya3k0oYndVlKH6nk7qXRm6gl9zQ2pG5nF5PYTwqjAS6ggNtIUQQCbiHCbqMhQMDvB+bwy30pvJMLfg/xVUaXMP4Oa3wJZQUQAPF+PVOjCCiggAIKiJLsZYTIrADGEhpdvE18wyd+iBGh8agw/noRHnFmAgq4HYytYzOePs03puCD5CkP3PbZ9fmkg+cXO+NDju6Rf58eVin5cLRc3vezpmRLy4Nds5v3te+WN7jpTYZO7m5QXU9PggdB4YHarIFiRgYybieh26KoY4TrhV+qCg/UkeA4KExaIuAAEn7tDp8lZXTuj1YC/nhgQ3sGkJ/e3G/NEdMAAAAASUVORK5CYII="},bd8e:function(t,e,n){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-wiki"},[t.wiki_post&&t.wiki_post.post?e("div",{staticClass:"m-wiki-post-panel"},[e("WikiPanel",{attrs:{"wiki-post":t.wiki_post}},[e("template",{slot:"head-title"},[e("svg",{class:"u-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"31.531",height:"31.531",viewBox:"0 0 31.531 31.531","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M11.872 24.961l-2.539.412a2.59 2.59 0 01-1.961-.468 2.606 2.606 0 01-1.043-1.72l-.223-1.482-4.407 4.407a.835.835 0 00.438 1.413l2.801.523.523 2.801a.838.838 0 001.413.438l5.755-5.755-.422-.427a.471.471 0 00-.335-.142z"}}),e("path",{attrs:{d:"M19.91 23.932l2.458.404a1.554 1.554 0 001.794-1.303l.37-2.458c.075-.492.383-.917.829-1.141l2.224-1.111a1.564 1.564 0 00.686-2.111L27.129 14a1.518 1.518 0 010-1.403l1.144-2.211c.19-.37.227-.802.098-1.199a1.57 1.57 0 00-.785-.911l-2.223-1.112a1.53 1.53 0 01-.829-1.14l-.37-2.458a1.556 1.556 0 00-.624-1.026 1.555 1.555 0 00-1.17-.279l-2.457.405a1.52 1.52 0 01-1.335-.434L16.828.459A1.568 1.568 0 0015.766 0a1.566 1.566 0 00-1.061.459l-1.75 1.773a1.52 1.52 0 01-1.335.434l-2.457-.405a1.554 1.554 0 00-1.17.279 1.556 1.556 0 00-.624 1.026l-.37 2.458a1.532 1.532 0 01-.83 1.14L3.947 8.276a1.568 1.568 0 00-.785.912c-.129.396-.093.829.097 1.199l1.144 2.211c.229.439.229.964 0 1.403l-1.143 2.21a1.563 1.563 0 00.687 2.111l2.224 1.111c.446.224.753.649.829 1.141l.37 2.458c.062.412.288.783.624 1.026a1.55 1.55 0 001.17.277l2.458-.404c.489-.082.987.08 1.335.436l1.75 1.771a1.55 1.55 0 001.059.459 1.55 1.55 0 001.059-.459l1.75-1.771a1.517 1.517 0 011.335-.435zm-4.144-1.39c-5.205-.026-9.431-4.266-9.431-9.477 0-5.21 4.226-9.451 9.431-9.478 5.205.026 9.432 4.268 9.432 9.478-.001 5.211-4.227 9.451-9.432 9.477z"}}),e("path",{attrs:{d:"M15.766 4.955c-4.444.028-8.05 3.648-8.05 8.097 0 4.447 3.606 8.068 8.05 8.096 4.444-.027 8.05-3.648 8.05-8.096-.001-4.448-3.606-8.069-8.05-8.097zM29.833 26.11l-4.407-4.407-.223 1.482a2.615 2.615 0 01-3.004 2.188l-2.539-.412a.468.468 0 00-.335.143l-.422.427 5.755 5.755a.838.838 0 001.413-.438l.522-2.801 2.801-.523a.837.837 0 00.439-1.414z"}})]),e("span",{staticClass:"u-txt"},[t._v(t._s(t.title))])]),e("template",{slot:"head-actions"},[e("a",{staticClass:"el-button el-button--primary",attrs:{href:t.publish_url}},[e("i",{staticClass:"el-icon-edit"}),e("span",[t._v("完善"+t._s(t.title))])])]),e("template",{slot:"body"},[t.compatible?e("div",{staticClass:"m-wiki-compatible"},[e("i",{staticClass:"el-icon-warning-outline"}),t._v(" 暂无缘起攻略，以下为重制攻略，仅作参考，"),e("a",{staticClass:"s-link",attrs:{href:t.publish_url}},[t._v("参与修订")]),t._v("。 ")]):t._e(),e("Article",{attrs:{content:t.wiki_post.post.content}}),e("div",{staticClass:"m-wiki-signature"},[e("i",{staticClass:"el-icon-edit"}),t._v(" 本次修订由 "),e("b",[t._v(t._s(t.user_name))]),t._v(" 提交于"+t._s(t.updated_at)+" ")]),e("Thx",{staticClass:"m-thx",attrs:{postId:t.id,postType:t.type,postTitle:t.source_title,adminBoxcoinEnable:!1,userBoxcoinEnable:!1}})],1)],2),e("WikiRevisions",{attrs:{type:t.source_type,"source-id":t.source_id,isGame:!0}})],1):t._e(),t.is_empty?e("div",{staticClass:"m-wiki-post-empty"},[e("i",{staticClass:"el-icon-s-opportunity"}),e("span",[t._v("暂无攻略，我要")]),e("a",{staticClass:"s-link",attrs:{href:t.publish_url}},[t._v("完善攻略")])]):t._e()])},s=[],a=(n("99af"),n("a974")),r=n("662c"),o=n("9307"),c=n("85e4"),l=n("1b86"),u={name:"Wiki",components:{WikiPanel:r["a"],WikiRevisions:o["a"],Article:a["a"]},props:["title","source_type","source_id","type","id","source_title"],data:function(){return{wiki_post:null,compatible:!1}},computed:{post_content:function(){var t;return null===(t=this.wiki_post)||void 0===t?void 0:t.post},is_empty:function(){var t;return!(null!==(t=this.wiki_post)&&void 0!==t&&t.post)},isRevision:function(){return!!this.$route.params.post_id},client:function(){return this.$store.state.client},params:function(){return{type:this.source_type,source_id:this.id,supply:1,client:this.client}},user_name:function(){var t,e;return null===(t=this.wiki_post)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.user_nickname},updated_at:function(){var t,e;return Object(c["ts2str"])(null===(t=this.wiki_post)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.updated)},publish_url:function(){return Object(c["publishLink"])("".concat(this.source_type,"/").concat(this.source_id))}},methods:{loadData:function(){var t=this;l["a"].mix({type:this.source_type,id:this.source_id,client:this.client},{supply:1}).then((function(e){var n=e.post,i=e.source,s=e.compatible,a=e.users;t.wiki_post={post:n,source:i,users:a},t.compatible=s}))}},watch:{source_id:{immediate:!0,handler:function(t){t&&this.loadData()}}},mounted:function(){}},d=u,m=(n("69ba"),n("2877")),p=Object(m["a"])(d,i,s,!1,null,null,null);e["a"]=p.exports},bed2:function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return o}));var i=n("41cb");n("65c2");function s(t){return Object(i["e"])().get("/serendipities",{params:t})}function a(t){return Object(i["e"])().get("/serendipity/".concat(t))}function r(t){return Object(i["e"])().get("/serendipity/".concat(t,"/task"))}function o(t){return Object(i["e"])().get("/serendipity/".concat(t,"/achievement"))}},d825:function(t,e,n){"use strict";var i=function(){var t=this,e=t._self._c;return e("WikiPanel",{staticClass:"c-wiki-comments",attrs:{scene:"detail"}},[e("template",{slot:"head-title"},[e("i",{staticClass:"el-icon-chat-line-round"}),e("span",[t._v("百科评论")])]),e("template",{slot:"body"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-comments-panel"},[t.comments&&t.comments.length?t._e():e("div",{staticClass:"u-empty"},[null===t.comments?e("span",[t._v("🎉 数据加载中...")]):t._e(),!1===t.comments?e("span",[t._v("⚠️ 数据加载异常")]):t._e(),t.comments&&!t.comments.length?e("span",[t._v("💧 暂无评论")]):t._e()]),e("Comment",{attrs:{comments:t.comments,"source-id":t.sourceId}}),e("el-pagination",{staticClass:"u-pagination-box",attrs:{background:"","hide-on-single-page":"","current-page":t.page,total:t.total,"page-size":t.pageSize,layout:"prev, pager, next, total"},on:{"current-change":t.handleCurrentChange}}),e("div",{staticClass:"m-reply-form",attrs:{id:"m-reply-form"}},[e("h4",{staticClass:"u-title"},[e("i",{staticClass:"el-icon-chat-dot-round"}),e("span",[t._v("回复")])]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reply_form.content,expression:"reply_form.content"}],staticClass:"u-reply-content",domProps:{value:t.reply_form.content},on:{input:function(e){e.target.composing||t.$set(t.reply_form,"content",e.target.value)}}}),e("div",{staticClass:"u-author"},[e("span",[t._v("昵称：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.reply_form.user_nickname,expression:"reply_form.user_nickname"}],attrs:{type:"text"},domProps:{value:t.reply_form.user_nickname},on:{input:function(e){e.target.composing||t.$set(t.reply_form,"user_nickname",e.target.value)}}})]),e("el-button",{staticClass:"u-submit",attrs:{type:"primary"},on:{click:function(e){return t.create_comment(t.reply_form)}}},[e("i",{staticClass:"el-icon-check"}),e("span",[t._v("提交")])])],1)],1)])],2)},s=[],a=(n("b0c0"),n("caad"),n("2532"),n("d81d"),n("14d9"),n("d3b7"),n("662c")),r=function(){var t=this,e=t._self._c;return e("ul",{staticClass:"u-comments"},t._l(t.comments,(function(n,i){return e("li",{key:i,staticClass:"u-comment-panel"},[e("div",{staticClass:"u-comment"},[e("div",{staticClass:"u-nickname-panel"},[e("a",{staticClass:"u-nickname",attrs:{href:n.user_id?t.author_url(n.user_id):null,target:"_blank"},domProps:{textContent:t._s(n.user_nickname)}}),n.parent_id?[e("span",[t._v(" 回复 ")]),e("a",{staticClass:"u-nickname",attrs:{href:n.parent.user_id?t.author_url(n.parent.user_id):null,target:"_blank"},domProps:{textContent:t._s(n.parent.user_nickname)}})]:t._e()],2),e("p",{staticClass:"u-content",domProps:{innerHTML:t._s(n.content)}}),e("div",{staticClass:"m-reply"},[n.reply_form&&n.reply_form.show?e("el-button",{staticClass:"u-reply",attrs:{type:"default"},on:{click:function(t){n.reply_form.show=!n.reply_form.show}}},[e("i",{staticClass:"el-icon-arrow-up"}),e("span",[t._v("收起")])]):e("el-button",{staticClass:"u-reply",attrs:{type:"primary",plain:""},on:{click:function(t){n.reply_form.show=!n.reply_form.show}}},[e("i",{staticClass:"el-icon-chat-dot-round"}),e("span",[t._v("回复")])]),e("span",{staticClass:"u-time",domProps:{textContent:t._s(t.ts2str(n.updated))}})],1),n.reply_form&&n.reply_form.show?e("div",{staticClass:"m-reply-form"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:n.reply_form.content,expression:"comment.reply_form.content"}],staticClass:"u-reply-content",domProps:{value:n.reply_form.content},on:{input:function(e){e.target.composing||t.$set(n.reply_form,"content",e.target.value)}}}),e("div",{staticClass:"u-author"},[e("span",[t._v("昵称：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:n.reply_form.user_nickname,expression:"comment.reply_form.user_nickname"}],attrs:{type:"text"},domProps:{value:n.reply_form.user_nickname},on:{input:function(e){e.target.composing||t.$set(n.reply_form,"user_nickname",e.target.value)}}})]),e("el-button",{staticClass:"u-submit",attrs:{type:"primary"},on:{click:function(e){return t.create_comment(n.reply_form,n.id)}}},[e("i",{staticClass:"el-icon-check"}),e("span",[t._v("提交")])])],1):t._e()]),n.children.length?e("WikiComment",{attrs:{comments:n.children,"source-id":t.sourceId}}):t._e()],1)})),0)},o=[],c=n("85e4"),l={name:"WikiComment",props:["comments","sourceId"],methods:{author_url:c["authorLink"],ts2str:c["ts2str"],create_comment:function(t,e){var n=this.$parent;n.create_comment||(n=n.$parent),n.create_comment?n.create_comment(t,e):this.$message({message:"发布评论异常，请联系管理员",type:"warning"})}}},u=l,d=n("2877"),m=Object(d["a"])(u,r,o,!1,null,null,null),p=m.exports,f=n("1b86"),v=n("c9d2"),h={name:"WikiComments",props:["type","sourceId"],data:function(){return{comments:null,reply_form:{content:"",user_nickname:v["a"].getInfo().name},page:1,pageSize:10,total:0,loading:!1}},computed:{client:function(){return location.href.includes("classic")||location.href.includes("origin")?"origin":"std"}},methods:{get_comments:function(){var t=this;function e(t,n){var i=[],s=function(){var s=t[a];if(!s)return"continue";if(s.parent_id===n){var r=e(s.children,s.id);s.children=r.map((function(t){return t.parent={user_id:s.user_id,user_nickname:s.user_nickname,id:s.id},t.reply_form={show:!1,content:"",user_nickname:v["a"].getInfo().name},t})),i.push(s)}};for(var a in t)s();return i}this.type&&this.sourceId&&(this.loading=!0,f["b"].list({type:this.type,id:this.sourceId},{client:this.client,page:this.page}).then((function(n){if(n=n.data,200===n.code){for(var i=n.data.comments,s=0;s<i.length;s++)i[s]["reply_form"]={show:!1,content:"",user_nickname:v["a"].getInfo().name};t.page=n.data.current_page,t.total=n.data.total,t.comments=e(i,0),t.loading=!1}}),(function(){t.comments=!1,t.loading=!1})))},create_comment:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t.content){var i={comment:{type:this.type,source_id:this.sourceId,parent_id:n,user_nickname:t.user_nickname||v["a"].getInfo().name,content:t.content},client:this.client};f["b"].post({data:i},{}).then((function(n){n=n.data,200===n.code?(t.content="",e.$message({message:"提交成功，请等待审核",type:"success"})):e.$message({message:"".concat(n.message),type:"warning"})}),(function(){e.$message({message:"网络异常，提交失败",type:"warning"})})).finally((function(){t.show=!1}))}else this.$message({message:"请先填写评论内容再尝试提交",type:"warning"})},handleCurrentChange:function(t){this.page=t,this.get_comments()}},components:{WikiPanel:a["a"],Comment:p},watch:{sourceId:{immediate:!0,handler:function(){this.get_comments()}}}},_=h,g=(n("8c22"),Object(d["a"])(_,i,s,!1,null,null,null));e["a"]=g.exports},d86b:function(t,e,n){var i=n("d039");t.exports=i((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},ed08:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));n("d3b7"),n("caad"),n("ac1f"),n("466d");function i(t){if("[object Object]"===Object.prototype.toString.call(t)){for(var e in t)[void 0,null,""].includes(t[e])&&delete t[e];return t}return t}function s(){var t=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);return null!==t}},ef52:function(t,e,n){"use strict";n("498b")},f183:function(t,e,n){var i=n("23e7"),s=n("e330"),a=n("d012"),r=n("861d"),o=n("1a2d"),c=n("9bf2").f,l=n("241c"),u=n("057f"),d=n("4fadd"),m=n("90e3"),p=n("bb2f"),f=!1,v=m("meta"),h=0,_=function(t){c(t,v,{value:{objectID:"O"+h++,weakData:{}}})},g=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,v)){if(!d(t))return"F";if(!e)return"E";_(t)}return t[v].objectID},b=function(t,e){if(!o(t,v)){if(!d(t))return!0;if(!e)return!1;_(t)}return t[v].weakData},y=function(t){return p&&f&&d(t)&&!o(t,v)&&_(t),t},k=function(){C.enable=function(){},f=!0;var t=l.f,e=s([].splice),n={};n[v]=1,t(n).length&&(l.f=function(n){for(var i=t(n),s=0,a=i.length;s<a;s++)if(i[s]===v){e(i,s,1);break}return i},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},C=t.exports={enable:k,fastKey:g,getWeakData:b,onFreeze:y};a[v]=!0}}]);
//# sourceMappingURL=chunk-5f7dfcc2.55820867.js.map