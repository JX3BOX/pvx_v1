{"version":3,"sources":["webpack:///./src/views/face/Parse.vue","webpack:///src/views/face/Parse.vue","webpack:///./src/views/face/Parse.vue?99e2","webpack:///./src/views/face/Parse.vue?3bdc","webpack:///./node_modules/@jx3box/jx3box-facedat/src/Facedat.vue?a231","webpack:///./node_modules/@jx3box/jx3box-facedat/src/Facedat.vue","webpack:///./node_modules/@jx3box/jx3box-facedat/src/fixOldData.js","webpack:///./node_modules/@jx3box/jx3box-facedat/src/DecalDatabase.js","webpack:///node_modules/@jx3box/jx3box-facedat/src/Facedat.vue","webpack:///./node_modules/@jx3box/jx3box-facedat/src/Facedat.vue?e0f2","webpack:///./node_modules/@jx3box/jx3box-facedat/src/Facedat.vue?ad63","webpack:///./src/views/face/Parse.vue?4054"],"names":["render","_vm","this","_c","_self","staticClass","class","on","done","_v","attrs","handleSuccess","directives","name","rawName","value","expression","json","staticRenderFns","props","data","computed","methods","mounted","components","Facedat","Upload","component","ready","tab_type","model","active","callback","$$v","_l","group","key","i","_s","dict","facedata","bone_range","body_type","lock","$set","cleandata","clean","checkdecal_prop","decalDb","getDecalIcon","getDecalName","getDecalIsFlip","_e","getDecalIsFree","getDecalPrice","getDecorationIcon","getDecorationName","showDecorationPrice","getTotalPrice","ref","$event","buildData","fixOldData","olddata","newdata","tBone","tDecal","nRoleType","misc","decal","forEach","nShowID","arr","item","url","local","sessionStorage","getItem","JSON","parse","a","get","then","res","setItem","stringify","decoration","bodyType","val","iconid","id","sum","client","_fetchWithCache","r","decal_group","version","decalMap","decorationMap","_cleandata","_","cloneDeep","nDecorationID","CanUseInCreate","decal_default","_this$facedata","_nMajorVersion","nMajorVersion","output_std","amendVersion","amendBone","output_origin","origin","includes","prop","decal_prop","output","table","format","eol","spaces","slice","e","console","log","watch","deep","handler","$forceUpdate","immediate","DecalDatabase","status","setBodyType","$notify","error","title","message","v","outputWithHeader","KData","blob","Blob","type","saveAs","Date","now","versions","nVersion","_bone","bone_default","_fixbone","Object","assign","amendDecal"],"mappings":"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","file":"js/chunk-2c73b6f3.f04007a0.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-facedata\"},[_c('div',{staticClass:\"m-face-parse\",class:{ on: _vm.done }},[_c('h1',{staticClass:\"m-face-parse-title\"},[_vm._v(\"捏脸数据解析器\")]),_c('Upload',{attrs:{\"type\":\"face\"},on:{\"success\":_vm.handleSuccess}}),_c('Facedat',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.done),expression:\"done\"}],staticClass:\"m-face-parse-preview\",attrs:{\"data\":_vm.json,\"lock\":false}})],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"m-facedata\">\n        <div class=\"m-face-parse\" :class=\"{ on: done }\">\n            <h1 class=\"m-face-parse-title\">捏脸数据解析器</h1>\n            <Upload type=\"face\" @success=\"handleSuccess\" />\n            <Facedat class=\"m-face-parse-preview\" :data=\"json\" :lock=\"false\" v-show=\"done\" />\n        </div>\n    </div>\n</template>\n\n<script>\nimport Facedat from \"@jx3box/jx3box-facedat/src/Facedat\";\nimport Upload from \"@jx3box/jx3box-facedat/src/Upload\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nexport default {\n    name: \"FacedataParse\",\n    props: [],\n    data: function () {\n        return {\n            data: \"\",\n            done: false,\n        };\n    },\n    computed: {\n        json: function () {\n            return this.data && this.data.json;\n        },\n    },\n    methods: {\n        handleSuccess: function (data) {\n            this.data = data;\n            if (data?.json) {\n                this.done = true;\n            } else {\n                this.done = false;\n            }\n        },\n    },\n    mounted: function () {\n    },\n    components: {\n        Facedat,\n        Upload,\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"~@/assets/css/face/parse.less\";\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Parse.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Parse.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Parse.vue?vue&type=template&id=322c0e0a&\"\nimport script from \"./Parse.vue?vue&type=script&lang=js&\"\nexport * from \"./Parse.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Parse.vue?vue&type=style&index=0&id=322c0e0a&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../vue-loader/lib/loaders/stylePostLoader.js!../../../postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../cache-loader/dist/cjs.js??ref--1-0!../../../vue-loader/lib/index.js??vue-loader-options!../../../vue-svg-inline-loader/dist/index.min.js!./Facedat.vue?vue&type=style&index=0&id=89ad90c8&prod&lang=less&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.ready)?_c('div',{staticClass:\"c-facedat\"},[_c('el-tabs',{staticClass:\"c-facedat-preivew\",attrs:{\"type\":_vm.tab_type},model:{value:(_vm.active),callback:function ($$v) {_vm.active=$$v},expression:\"active\"}},[_c('el-tab-pane',{attrs:{\"label\":\"眼部轮廓\",\"name\":\"eye\"}},[_c('div',{staticClass:\"c-facedat-group\"},[_c('ul',{staticClass:\"u-list\"},_vm._l((_vm.group['eye']),function(key,i){return _c('li',{key:key + i},[_c('label',[_vm._v(_vm._s(_vm.dict[key][\"desc\"]))]),_c('span',[_vm._v(_vm._s(_vm.facedata[\"tBone\"][key]))]),_c('el-slider',{staticClass:\"u-range\",attrs:{\"min\":_vm.bone_range[_vm.body_type][_vm.dict[key]['type']]['min'],\"max\":_vm.bone_range[_vm.body_type][_vm.dict[key]['type']]['max'],\"disabled\":_vm.lock},model:{value:(_vm.facedata['tBone'][key]),callback:function ($$v) {_vm.$set(_vm.facedata['tBone'], key, $$v)},expression:\"facedata['tBone'][key]\"}})],1)}),0)])]),_c('el-tab-pane',{attrs:{\"label\":\"嘴部轮廓\",\"name\":\"mouth\"}},[_c('div',{staticClass:\"c-facedat-group\"},[_c('ul',{staticClass:\"u-list\"},_vm._l((_vm.group['mouth']),function(key,i){return _c('li',{key:key + i},[_c('label',[_vm._v(_vm._s(_vm.dict[key][\"desc\"]))]),_c('span',[_vm._v(_vm._s(_vm.facedata[\"tBone\"][key]))]),_c('el-slider',{staticClass:\"u-range\",attrs:{\"min\":_vm.bone_range[_vm.body_type][_vm.dict[key]['type']]['min'],\"max\":_vm.bone_range[_vm.body_type][_vm.dict[key]['type']]['max'],\"disabled\":_vm.lock},model:{value:(_vm.facedata['tBone'][key]),callback:function ($$v) {_vm.$set(_vm.facedata['tBone'], key, $$v)},expression:\"facedata['tBone'][key]\"}})],1)}),0)])]),_c('el-tab-pane',{attrs:{\"label\":\"鼻子轮廓\",\"name\":\"nose\"}},[_c('div',{staticClass:\"c-facedat-group\"},[_c('ul',{staticClass:\"u-list\"},_vm._l((_vm.group['nose']),function(key,i){return _c('li',{key:key + i},[_c('label',[_vm._v(_vm._s(_vm.dict[key][\"desc\"]))]),_c('span',[_vm._v(_vm._s(_vm.facedata[\"tBone\"][key]))]),_c('el-slider',{staticClass:\"u-range\",attrs:{\"min\":_vm.bone_range[_vm.body_type][_vm.dict[key]['type']]['min'],\"max\":_vm.bone_range[_vm.body_type][_vm.dict[key]['type']]['max'],\"disabled\":_vm.lock},model:{value:(_vm.facedata['tBone'][key]),callback:function ($$v) {_vm.$set(_vm.facedata['tBone'], key, $$v)},expression:\"facedata['tBone'][key]\"}})],1)}),0)])]),_c('el-tab-pane',{attrs:{\"label\":\"脸部轮廓\",\"name\":\"face\"}},[_c('div',{staticClass:\"c-facedat-group\"},[_c('ul',{staticClass:\"u-list\"},_vm._l((_vm.group['face']),function(key,i){return _c('li',{key:key + i},[_c('label',[_vm._v(_vm._s(_vm.dict[key][\"desc\"]))]),_c('span',[_vm._v(_vm._s(_vm.facedata[\"tBone\"][key]))]),_c('el-slider',{staticClass:\"u-range\",attrs:{\"min\":_vm.bone_range[_vm.body_type][_vm.dict[key]['type']]['min'],\"max\":_vm.bone_range[_vm.body_type][_vm.dict[key]['type']]['max'],\"disabled\":_vm.lock},model:{value:(_vm.facedata['tBone'][key]),callback:function ($$v) {_vm.$set(_vm.facedata['tBone'], key, $$v)},expression:\"facedata['tBone'][key]\"}})],1)}),0)])]),_c('el-tab-pane',{attrs:{\"label\":\"贴花\",\"name\":\"decal\"}},[_c('div',{staticClass:\"m-facedat-decals\",attrs:{\"id\":\"decals\"}},[_vm._l((_vm.group['decal']),function(key,i){return _c('div',{key:key + i,staticClass:\"c-facedat-group\"},[(_vm.cleandata['tDecal'][key])?[_c('ul',{staticClass:\"u-decals\"},[_c('li',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.clean || _vm.checkdecal_prop(key)),expression:\"!clean || checkdecal_prop(key)\"}]},[_c('div',{staticClass:\"u-title\"},[_vm._v(\" \"+_vm._s(_vm.dict[key][\"desc\"])+\" \")]),_c('img',{staticClass:\"u-pic\",attrs:{\"src\":_vm.decalDb.getDecalIcon(\n                      key,\n                      _vm.cleandata['tDecal'][key]['nShowID']\n                    )}}),_c('span',{staticClass:\"u-dname\"},[_vm._v(_vm._s(_vm.decalDb.getDecalName( key, _vm.cleandata[\"tDecal\"][key][\"nShowID\"] )))]),(\n                    _vm.decalDb.getDecalIsFlip(\n                      key,\n                      _vm.cleandata['tDecal'][key]['nShowID']\n                    )\n                  )?_c('span',{staticClass:\"u-dflip\"},[_vm._v(\"(翻转)\")]):_vm._e(),_c('span',{staticClass:\"u-dcolor\"},[_vm._v(\"(颜色:\"+_vm._s(_vm.cleandata[\"tDecal\"][key][\"nColorID\"])+\")\")]),(\n                    _vm.decalDb.getDecalIsFree(\n                      key,\n                      _vm.cleandata['tDecal'][key]['nShowID']\n                    )\n                  )?_c('span',{staticClass:\"u-free\"},[_c('i',{staticClass:\"el-icon-success\"}),_vm._v(\" 新建角色可用 \")]):_vm._e(),(\n                    _vm.decalDb.getDecalPrice(\n                      key,\n                      _vm.cleandata['tDecal'][key]['nShowID']\n                    )\n                  )?_c('span',{staticClass:\"u-price\"},[_c('i',{staticClass:\"el-icon-coin\"}),_vm._v(\" \"+_vm._s(_vm.decalDb.getDecalPrice( key, _vm.cleandata[\"tDecal\"][key][\"nShowID\"] ))+\" 通宝 \")]):_vm._e()])])]:_vm._e()],2)}),_c('div',{staticClass:\"c-facedat-group\"},[_c('ul',{staticClass:\"u-decals\"},[_c('div',{staticClass:\"u-title\"},[_vm._v(\"装饰物\")]),_c('img',{staticClass:\"u-pic\",attrs:{\"src\":_vm.decalDb.getDecorationIcon(_vm.cleandata['nDecorationID'])}}),_c('span',{staticClass:\"u-dname\"},[_vm._v(_vm._s(_vm.decalDb.getDecorationName(_vm.cleandata[\"nDecorationID\"])))]),(_vm.decalDb.showDecorationPrice(_vm.cleandata['nDecorationID']))?_c('span',{staticClass:\"u-price\"},[_c('i',{staticClass:\"el-icon-coin\"}),_vm._v(\" \"+_vm._s(_vm.decalDb.showDecorationPrice(_vm.cleandata[\"nDecorationID\"]))+\" 通宝 \")]):_vm._e()])]),_c('div',{staticClass:\"c-facedat-group\"},[_c('ul',{staticClass:\"u-decals\"},[_c('div',{staticClass:\"u-title\"},[_vm._v(\"总计\")]),_c('span',{staticClass:\"u-total u-price\"},[_c('i',{staticClass:\"el-icon-coin\"}),_c('b',[_vm._v(_vm._s(_vm.decalDb.getTotalPrice(_vm.cleandata)))]),_vm._v(\" 通宝\")])])])],2)])],1),_c('div',{staticClass:\"c-facedat-setting\"},[_c('el-form',{ref:\"form\",staticClass:\"c-facedat-setting-form\",attrs:{\"label-width\":\"80px\",\"label-position\":\"left\"}},[_c('el-form-item',{attrs:{\"label\":\"高级\"}},[_c('el-checkbox',{model:{value:(_vm.clean),callback:function ($$v) {_vm.clean=$$v},expression:\"clean\"}},[_vm._v(\"清洗模式\")]),_c('span',{staticClass:\"u-warning\"},[_c('i',{staticClass:\"el-icon-warning-outline\"}),_vm._v(\" 仅保留创建新角色时可用项，如提示非法数据也请尝试开启该模式 \")])],1)],1)],1),_c('div',{staticClass:\"c-facedat-btns\"},[_c('el-button',{staticClass:\"u-btn\",attrs:{\"type\":\"primary\",\"icon\":\"el-icon-receiving\"},on:{\"click\":function($event){return _vm.buildData('std')}}},[_vm._v(\"导出正式服\")]),_c('el-button',{staticClass:\"u-btn\",attrs:{\"type\":\"warning\",\"icon\":\"el-icon-receiving\"},on:{\"click\":function($event){return _vm.buildData('origin')}}},[_vm._v(\"导出怀旧服\")])],1)],1):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// 将早期数据统一成当前格式\nfunction fixOldData(olddata) {\n    let newdata = {\n        tBone: {},\n        tDecal: {},\n        nRoleType: ~~olddata.misc[0].value,\n    };\n\n    olddata.decal.forEach((decal) => {\n        newdata.tDecal[decal.name] = {\n            nShowID : ~~decal.value\n        }\n    })\n\n    let arr = ['eye','mouth','nose','face']\n    arr.forEach((key) => {\n        olddata[key].forEach((item) => {\n            newdata.tBone[item.name] = ~~item.value\n        })\n    })\n\n    return newdata\n}\n\nexport default fixOldData;\n","import axios from \"axios\";\nimport _ from \"lodash\";\nimport { __ossMirror, __iconPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport dict from \"../assets/data/face/dict.json\";\nimport group from \"../assets/data/face/group.json\";\n\nexport class DecalDatabase {\n    _fetchWithCache(key, url, callback) {\n        // 优先使用本地缓存\n        try {\n            const local = sessionStorage.getItem(key);\n            if (local) {\n                callback(JSON.parse(local));\n                return;\n            }\n        }\n        catch { }\n\n        // 本地缓存无效，获取并写入\n        try {\n            axios.get(url).then((res) => {\n                // 写缓存可能炸？炸就不管了\n                try {\n                    sessionStorage.setItem(key, JSON.stringify(res.data));\n                }\n                catch { }\n                callback(res.data);\n            });\n        }\n        catch {\n            callback(\"\");\n        }\n    }\n\n    ready() {\n        return this.decal && this.decoration;\n    }\n\n    setBodyType(bodyType) {\n        this.bodyType = bodyType;\n    }\n\n    // 贴花\n    getDecalName(key, val) {\n        return (\n            _.get(this.decal[this.bodyType][dict[key][\"type\"]][val], \"name\") ||\n            \"无\"\n        );\n    }\n    getDecalIcon(key, val) {\n        /*let iconid = _.get(\n            this.decal[this.bodyType][dict[key][\"type\"]][val],\n            \"iconid\"\n        );*/\n        let iconid = _.get(this.decal, [this.bodyType, dict[key][\"type\"], val, \"iconid\"]);\n        return __iconPath + \"icon/\" + (iconid || \"undefined\") + \".png\";\n    }\n    getDecalIsFlip(key, val) {\n        return (\n            _.get(\n                this.decal[this.bodyType][dict[key][\"type\"]][val],\n                \"IsFlip\"\n            ) || false\n        );\n    }\n    getDecalIsFree(key, val) {\n        /*if (this.decal?.[this.bodyType]?.[dict[key]?.type]?.[val])\n            return ~~this.decal?.[this.bodyType]?.[dict[key]?.type]?.[val]\n                ?.CanUseInCreate;\n        else    // 不存在的贴花\n            return -1;\n            */\n        return ~~(_.get(this.decal, [this.bodyType, _.get(dict, [key, \"type\"]), val, \"CanUseInCreate\"], -1))\n    }\n    getDecalPrice(key, val) {\n        /*return ~~this.decal?.[this.bodyType]?.[dict[key]?.type]?.[val]\n            ?.CoinPrice;*/\n        return ~~(_.get(this.decal, [this.bodyType, _.get(dict, [key, \"type\"]), val, \"CoinPrice\"], 0))\n    }\n\n    // 装饰物\n    getDecorationName(id) {\n        return _.get(this.decoration[this.bodyType][id], \"Name\") || \"无\";\n    }\n    getDecorationIcon(id) {\n        //let iconid = _.get(this.decoration[this.bodyType][id], \"IconID\");\n        let iconid = _.get(this.decoration, [this.bodyType, id, \"IconID\"]);\n        return __iconPath + \"icon/\" + (iconid || \"undefined\") + \".png\";\n        /*if (iconid) {\n            return __iconPath + \"icon/\" + iconid + \".png\";\n        } else {\n            return __iconPath + \"icon/\" + \"undefined\" + \".png\";\n        }*/\n    }\n    showDecorationPrice(id) {\n        return ~~(\n            _.get(this.decoration[this.bodyType][id], \"CoinPrice\") || \"0\"\n        );\n    }\n\n    // 所有\n    getTotalPrice(data) {\n        let sum = 0;\n        for (let key in data[\"tDecal\"]) {\n            if (data[\"tDecal\"][key])\n                sum += this.getDecalPrice(\n                    key,\n                    data[\"tDecal\"][key][\"nShowID\"]\n                );\n        }\n        if (data[\"nDecorationID\"])\n            sum += this.showDecorationPrice(this.cleandata[\"nDecorationID\"]);\n        return sum;\n    }\n    canUseInCreate(data) {\n        if (data[\"nDecorationID\"])\n            return false;\n        for (let key in data[\"tDecal\"])\n            if (data[\"tDecal\"][key] && this.getDecalIsFree(key, data[\"tDecal\"][key][\"nShowID\"]) === 0)\n                return false;\n        return true;\n    }\n\n    constructor(client = \"std\") {\n        this.client = client;\n        this.decal = {};\n        this.decoration = {};\n        this.bodyType = 0;\n        this._fetchWithCache(`decal_${client}`, `${__ossMirror}data/face/decal_${client}.json`, r => this.decal = r);\n        this._fetchWithCache(`decoration_${client}`, `${__ossMirror}data/face/decoration_${client}.json`, r => this.decoration = r);\n    }\n}\n","<template>\n  <div class=\"c-facedat\" v-if=\"ready\">\n    <el-tabs class=\"c-facedat-preivew\" v-model=\"active\" :type=\"tab_type\">\n      <el-tab-pane label=\"眼部轮廓\" name=\"eye\">\n        <div class=\"c-facedat-group\">\n          <ul class=\"u-list\">\n            <li v-for=\"(key, i) in group['eye']\" :key=\"key + i\">\n              <label>{{ dict[key][\"desc\"] }}</label>\n              <span>{{ facedata[\"tBone\"][key] }}</span>\n              <el-slider\n                class=\"u-range\"\n                :min=\"bone_range[body_type][dict[key]['type']]['min']\"\n                :max=\"bone_range[body_type][dict[key]['type']]['max']\"\n                v-model=\"facedata['tBone'][key]\"\n                :disabled=\"lock\"\n              ></el-slider>\n            </li>\n          </ul>\n        </div>\n      </el-tab-pane>\n      <el-tab-pane label=\"嘴部轮廓\" name=\"mouth\">\n        <div class=\"c-facedat-group\">\n          <ul class=\"u-list\">\n            <li v-for=\"(key, i) in group['mouth']\" :key=\"key + i\">\n              <label>{{ dict[key][\"desc\"] }}</label>\n              <span>{{ facedata[\"tBone\"][key] }}</span>\n              <el-slider\n                class=\"u-range\"\n                :min=\"bone_range[body_type][dict[key]['type']]['min']\"\n                :max=\"bone_range[body_type][dict[key]['type']]['max']\"\n                v-model=\"facedata['tBone'][key]\"\n                :disabled=\"lock\"\n              ></el-slider>\n            </li>\n          </ul>\n        </div>\n      </el-tab-pane>\n      <el-tab-pane label=\"鼻子轮廓\" name=\"nose\">\n        <div class=\"c-facedat-group\">\n          <ul class=\"u-list\">\n            <li v-for=\"(key, i) in group['nose']\" :key=\"key + i\">\n              <label>{{ dict[key][\"desc\"] }}</label>\n              <span>{{ facedata[\"tBone\"][key] }}</span>\n              <el-slider\n                class=\"u-range\"\n                :min=\"bone_range[body_type][dict[key]['type']]['min']\"\n                :max=\"bone_range[body_type][dict[key]['type']]['max']\"\n                v-model=\"facedata['tBone'][key]\"\n                :disabled=\"lock\"\n              ></el-slider>\n            </li>\n          </ul>\n        </div>\n      </el-tab-pane>\n      <el-tab-pane label=\"脸部轮廓\" name=\"face\">\n        <div class=\"c-facedat-group\">\n          <ul class=\"u-list\">\n            <li v-for=\"(key, i) in group['face']\" :key=\"key + i\">\n              <label>{{ dict[key][\"desc\"] }}</label>\n              <span>{{ facedata[\"tBone\"][key] }}</span>\n              <el-slider\n                class=\"u-range\"\n                :min=\"bone_range[body_type][dict[key]['type']]['min']\"\n                :max=\"bone_range[body_type][dict[key]['type']]['max']\"\n                v-model=\"facedata['tBone'][key]\"\n                :disabled=\"lock\"\n              ></el-slider>\n            </li>\n          </ul>\n        </div>\n      </el-tab-pane>\n      <el-tab-pane label=\"贴花\" name=\"decal\">\n        <div class=\"m-facedat-decals\" id=\"decals\">\n          <div\n            class=\"c-facedat-group\"\n            v-for=\"(key, i) in group['decal']\"\n            :key=\"key + i\"\n          >\n            <template v-if=\"cleandata['tDecal'][key]\">\n              <ul class=\"u-decals\">\n                <li v-show=\"!clean || checkdecal_prop(key)\">\n                  <div class=\"u-title\">\n                    {{ dict[key][\"desc\"] }}\n                  </div>\n                  <img\n                    class=\"u-pic\"\n                    :src=\"\n                      decalDb.getDecalIcon(\n                        key,\n                        cleandata['tDecal'][key]['nShowID']\n                      )\n                    \"\n                  />\n                  <span class=\"u-dname\">{{\n                    decalDb.getDecalName(\n                      key,\n                      cleandata[\"tDecal\"][key][\"nShowID\"]\n                    )\n                  }}</span>\n                  <span\n                    class=\"u-dflip\"\n                    v-if=\"\n                      decalDb.getDecalIsFlip(\n                        key,\n                        cleandata['tDecal'][key]['nShowID']\n                      )\n                    \"\n                    >(翻转)</span\n                  >\n                  <span class=\"u-dcolor\"\n                    >(颜色:{{ cleandata[\"tDecal\"][key][\"nColorID\"] }})</span\n                  >\n                  <span\n                    class=\"u-free\"\n                    v-if=\"\n                      decalDb.getDecalIsFree(\n                        key,\n                        cleandata['tDecal'][key]['nShowID']\n                      )\n                    \"\n                  >\n                    <i class=\"el-icon-success\"></i>\n                    新建角色可用\n                  </span>\n                  <span\n                    class=\"u-price\"\n                    v-if=\"\n                      decalDb.getDecalPrice(\n                        key,\n                        cleandata['tDecal'][key]['nShowID']\n                      )\n                    \"\n                  >\n                    <i class=\"el-icon-coin\"></i>\n                    {{\n                      decalDb.getDecalPrice(\n                        key,\n                        cleandata[\"tDecal\"][key][\"nShowID\"]\n                      )\n                    }}\n                    通宝\n                  </span>\n                </li>\n              </ul>\n            </template>\n          </div>\n          <div class=\"c-facedat-group\">\n            <ul class=\"u-decals\">\n              <div class=\"u-title\">装饰物</div>\n              <img\n                class=\"u-pic\"\n                :src=\"decalDb.getDecorationIcon(cleandata['nDecorationID'])\"\n              />\n              <span class=\"u-dname\">{{\n                decalDb.getDecorationName(cleandata[\"nDecorationID\"])\n              }}</span>\n              <span\n                class=\"u-price\"\n                v-if=\"decalDb.showDecorationPrice(cleandata['nDecorationID'])\"\n              >\n                <i class=\"el-icon-coin\"></i>\n                {{ decalDb.showDecorationPrice(cleandata[\"nDecorationID\"]) }}\n                通宝\n              </span>\n            </ul>\n          </div>\n          <div class=\"c-facedat-group\">\n            <ul class=\"u-decals\">\n              <div class=\"u-title\">总计</div>\n              <span class=\"u-total u-price\"\n                ><i class=\"el-icon-coin\"></i>\n                <b>{{ decalDb.getTotalPrice(cleandata) }}</b> 通宝</span\n              >\n            </ul>\n          </div>\n        </div>\n      </el-tab-pane>\n    </el-tabs>\n    <div class=\"c-facedat-setting\">\n      <el-form\n        class=\"c-facedat-setting-form\"\n        ref=\"form\"\n        label-width=\"80px\"\n        label-position=\"left\"\n      >\n        <el-form-item label=\"高级\">\n          <el-checkbox v-model=\"clean\">清洗模式</el-checkbox>\n          <span class=\"u-warning\">\n            <i class=\"el-icon-warning-outline\"></i>\n            仅保留创建新角色时可用项，如提示非法数据也请尝试开启该模式\n          </span>\n        </el-form-item>\n      </el-form>\n    </div>\n    <div class=\"c-facedat-btns\">\n      <el-button\n        class=\"u-btn\"\n        type=\"primary\"\n        @click=\"buildData('std')\"\n        icon=\"el-icon-receiving\"\n        >导出正式服</el-button\n      >\n      <el-button\n        class=\"u-btn\"\n        type=\"warning\"\n        @click=\"buildData('origin')\"\n        icon=\"el-icon-receiving\"\n        >导出怀旧服</el-button\n      >\n    </div>\n  </div>\n</template>\n\n<script>\nimport _ from \"lodash\";\nimport axios from \"axios\";\nimport {\n  __ossMirror,\n  __iconPath,\n  __ossRoot,\n} from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport fixOldData from \"./fixOldData.js\";\n\nimport group from \"../assets/data/face/group.json\";\nimport dict from \"../assets/data/face/dict.json\";\nimport decal_group from \"../assets/data/face/decal_group.json\";\nimport decal_origin from \"../assets/data/face/decal_origin.json\";\nimport decal_std from \"../assets/data/face/decal_std.json\";\nimport decal_prop from \"../assets/data/face/decal_prop.json\";\nimport bone_range from \"../assets/data/face/bone_range.json\";\nimport bone_default from \"../assets/data/face/bone_default.json\";\nimport decal_default from \"../assets/data/face/decal_default.json\";\nimport versions from \"../assets/data/face/version.json\";\n\nimport { DecalDatabase } from \"./DecalDatabase\"\nimport { format } from \"lua-json\";\nimport { saveAs } from \"file-saver\";\nimport * as KData from \"./KData\";\n\nexport default {\n  name: \"Facedat\",\n  props: [\"data\", \"lock\", \"tab_type\"],\n  data: function () {\n    return {\n      active: \"eye\",\n\n      // 数据\n      body_type: \"\",\n      facedata: \"\",\n\n      // 骨骼\n      group,\n      dict,\n      bone_range,\n\n      // 妆容\n      decal_group,\n\n      // 导出设置\n      clean: false,\n      version: \"std\",\n\n      decalDb: null,\n      decalMap: \"\",\n      decorationMap: \"\",\n\n      // test\n      // data : JSON.stringify(olddata)\n    };\n  },\n  computed: {\n    ready: function () {\n      return !!(this.facedata && this.decalDb.ready());\n    },\n    cleandata: function () {\n      if (this.clean && this.facedata) {\n        let _cleandata = _.cloneDeep(this.facedata);\n        _cleandata.nDecorationID = 0;\n        for (let key in _cleandata.tDecal) {\n          let CanUseInCreate = this.decalDb.getDecalIsFree(\n            key,\n            _cleandata?.tDecal[key][\"nShowID\"]\n          );\n          if (!CanUseInCreate) {\n            _cleandata.tDecal[key][\"nShowID\"] = decal_default[key][\"nShowID\"];\n          }\n        }\n        return _cleandata;\n      } else {\n        return this.facedata;\n      }\n    },\n    // 自动检测数据版本\n    client: function () {\n      let _nMajorVersion = this.facedata?.nMajorVersion;\n      if (_nMajorVersion == 1 || !_nMajorVersion) {\n        return \"std\";\n      } else {\n        return \"origin\";\n      }\n    },\n    /* decalmap: function() {\n            if (this.client == \"std\" || !this.client) {\n                return decal_std;\n            } else {\n                return decal_origin;\n            }\n        }, */\n    output_std: function () {\n      // 1.默认需要修订版本号与客户端版本\n      let data = this.amendVersion(\"std\");\n      // 2.补全骨骼缺失数据\n      data.tBone = this.amendBone(data.tBone);\n      // 3.补全完整数据结构\n      // 如果没有开启清洗也需要对数据结构进行补充，以防上传的是古老的数据（缺失部分后加的属性）\n      // 同时部分古老数据即使存在该属性，但部分2级属性也是缺失的\n      // data.tDecal = this.amendDecal(data.tDecal)\n\n      // 废弃：如果开启了清洗直接回档整体默认贴花部分\n      // 正式服数据包含全部属性（shadow1~4），且有额外属性值（fValue1~3）\n      // 直接取一个demo数据，以防上传的是怀旧服数据缺失部分属性\n      if (this.clean) {\n        data.tDecal = _.cloneDeep(decal_default);\n      }\n\n      // 废弃：如果是清洗模式，还需要仅保留新建角色时存在的属性（移除shadow1~4等）\n      // if (this.clean){\n      //     for(let key in data.tDecal){\n      //         if (!decal_group.origin.includes(key)) {\n      //             delete data.tDecal[key];\n      //         }\n      //     }\n      // }\n      return data;\n    },\n    output_origin: function () {\n      // 1.默认需要修订版本号与客户端版本\n      let data = this.amendVersion(\"origin\");\n      // 2.补全骨骼缺失数据\n      data.tBone = this.amendBone(data.tBone);\n\n      // 3.贴花数据全部复位（怀旧服商城暂未上线）\n      for (let key in data.tDecal) {\n        if (decal_group.origin.includes(key)) {\n          // 3.2重置color和show_id\n          data.tDecal[key][\"nColorID\"] = decal_default[key][\"nColorID\"];\n          data.tDecal[key][\"nShowID\"] = decal_default[key][\"nShowID\"];\n          // 3.3移除正式服特有属性（fValue1~3）\n          for (let prop in data.tDecal[key]) {\n            if (!decal_prop.origin.includes(prop)) {\n              delete data.tDecal[key][prop];\n            }\n          }\n          // 3.1首先移除正式服特有的部分属性（shadow1~4）\n        } else {\n          delete data.tDecal[key];\n        }\n      }\n      return data;\n    },\n    output: function () {\n      let table = {};\n      let data =\n        this.version == \"origin\" ? this.output_origin : this.output_std;\n      try {\n        table = \"return \" + format(data, { eol: \"\", spaces: 0 }).slice(6);\n      } catch (e) {\n        console.log(\"导出转换失败\");\n        console.log(e);\n      }\n      return table;\n    },\n  },\n  watch: {\n    data: {\n      deep: true,\n      handler: function (newdata) {\n        this.render();\n      },\n    },\n    cleandata: {\n      deep: true,\n      handler: function () {\n        this.$forceUpdate();\n      },\n    },\n    client: {\n      immediate: true,\n      handler: function (val) {\n        this.decalDb = new DecalDatabase(this.client);\n      },\n    },\n  },\n  methods: {\n    // 数据构建\n    render: function () {\n      // 是否为空\n      if (!this.data) {\n        this.body_type = \"\";\n        this.facedata = \"\";\n        return;\n      }\n\n      // json 转为 object\n      try {\n        let facedata = JSON.parse(this.data);\n        // 旧版数据\n        this.body_type = facedata.status ? facedata.misc[0][\"value\"] : facedata.nRoleType;\n        this.decalDb.setBodyType(this.body_type);\n        this.facedata = facedata.status ? fixOldData(facedata) : facedata;\n      } catch (e) {\n        this.facedata = \"\";\n        console.log(e);\n        this.$notify.error({\n          title: \"错误\",\n          message: \"脸型数据无法解析\",\n        });\n      }\n    },\n\n\n    // 按钮\n    buildData: function (v) {\n      this.version = v;\n      let outputWithHeader = KData.dump(this.output);\n      let blob = new Blob([outputWithHeader], {\n        type: \"application/dat;charset=utf-8\",\n      });\n      saveAs(blob, Date.now() + \".dat\");\n    },\n\n    // 数据修正\n    amendVersion: function (v) {\n      let data = _.cloneDeep(this.cleandata);\n      data.nDecorationID = v === \"origin\" ? 0 : data.nDecorationID;\n      data.nMajorVersion = versions[v][\"nMajorVersion\"];\n      data.nVersion = versions[v][\"nVersion\"];\n      return data;\n    },\n    amendBone: function (data) {\n      let _bone = _.cloneDeep(bone_default);\n      let _fixbone = Object.assign(_bone, data);\n      return _fixbone;\n    },\n    amendDecal: function (data) {\n      let _decal = _.cloneDeep(decal_default);\n      for (let key in decal_default) {\n        // 不存在补全属性\n        if (!data[key]) {\n          data[key] = _.cloneDeep(decal_default[key]);\n          // 存在则补全子属性\n        } else {\n          data[key] = Object.assign(decal_default[key], data[key]);\n        }\n      }\n      return data;\n    },\n    checkdecal_prop: function (key) {\n      return decal_group.origin.includes(key);\n    },\n  },\n  mounted: function () {\n    this.render();\n  },\n};\n</script>\n\n<style lang=\"less\">\n@import \"../assets/css/facedat.less\";\n</style>\n","import mod from \"-!../../../cache-loader/dist/cjs.js??ref--13-0!../../../thread-loader/dist/cjs.js!../../../babel-loader/lib/index.js!../../../cache-loader/dist/cjs.js??ref--1-0!../../../vue-loader/lib/index.js??vue-loader-options!../../../vue-svg-inline-loader/dist/index.min.js!./Facedat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../cache-loader/dist/cjs.js??ref--13-0!../../../thread-loader/dist/cjs.js!../../../babel-loader/lib/index.js!../../../cache-loader/dist/cjs.js??ref--1-0!../../../vue-loader/lib/index.js??vue-loader-options!../../../vue-svg-inline-loader/dist/index.min.js!./Facedat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Facedat.vue?vue&type=template&id=89ad90c8&\"\nimport script from \"./Facedat.vue?vue&type=script&lang=js&\"\nexport * from \"./Facedat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Facedat.vue?vue&type=style&index=0&id=89ad90c8&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Parse.vue?vue&type=style&index=0&id=322c0e0a&prod&lang=less&\""],"sourceRoot":""}