{"version":3,"sources":["webpack:///./node_modules/@jx3box/jx3box-map/src/components/Map.vue?f829","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiRevisions.vue?6df4","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiComments.vue?0877","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiRevisions.vue","webpack:///node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiRevisions.vue","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiRevisions.vue?4e84","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiRevisions.vue?44da","webpack:///./node_modules/@jx3box/jx3box-map/src/components/Map.vue","webpack:///node_modules/@jx3box/jx3box-map/src/components/Map.vue","webpack:///./node_modules/@jx3box/jx3box-map/src/components/Map.vue?12fe","webpack:///./node_modules/@jx3box/jx3box-map/src/components/Map.vue?c0ed","webpack:///./node_modules/core-js/modules/es.object.keys.js","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiComments.vue","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiComment.vue","webpack:///node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiComment.vue","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiComment.vue?6c0f","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiComment.vue?3144","webpack:///node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiComments.vue","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiComments.vue?8ccb","webpack:///./node_modules/@jx3box/jx3box-common-ui/src/wiki/WikiComments.vue?210a"],"names":["render","_vm","this","_c","_self","staticClass","attrs","slot","_v","versions","length","_e","_l","ver","key","link","type","concat","source_id","id","domProps","_s","on","$event","redirectRevision","ts2str","updated","user_id","author_url","user_nickname","remark","staticRenderFns","name","props","data","computed","client","location","href","includes","baseUrl","__OriginRoot","__Root","prefix","isGame","slice","methods","getLink","uid","authorLink","e","$router","preventDefault","replace","path","components","WikiPanel","watch","sourceId","immediate","handler","_this","wiki","then","res","code","component","ref","style","wrapperSize","mapImg","_t","mapName","datas","i","k","pointStyle","title","content","mapId","Number","default","Array","popoverContent","width","height","subId","scales","mapScales","Object","keys","_sub","_subScale","sub","rect","x","StartX","y","StartY","Width","Scale","Height","isPointsInRect","Name","mapScale","jx3boxData","__imgPath","mounted","$nextTick","updateSize","window","addEventListener","beforeDestroy","removeEventListener","item","scale","left","bottom","points","map","p","every","_this$$refs$component","$refs","clientWidth","$emit","$","toObject","nativeKeys","fails","FAILS_ON_PRIMITIVES","target","stat","forced","it","directives","rawName","value","loading","expression","comments","page","total","pageSize","handleCurrentChange","reply_form","composing","$set","create_comment","comment","parent_id","parent","show","children","form","app","$parent","$message","message","User","getInfo","get_comments","filter","outputs","_loop","c","index","push","wikiComment","list","current_page","_this2","arguments","undefined","post","finally","Comment"],"mappings":"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","file":"js/chunk-1da9542e.2fa495d0.js","sourcesContent":["export * from \"-!../../../../mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./Map.vue?vue&type=style&index=0&id=0651a7b8&prod&lang=less&scoped=true&\"","export * from \"-!../../../../mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./WikiRevisions.vue?vue&type=style&index=0&id=d5208e68&prod&lang=less&\"","export * from \"-!../../../../mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./WikiComments.vue?vue&type=style&index=0&id=3ac92298&prod&lang=less&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('WikiPanel',{staticClass:\"c-wiki-revisions\",attrs:{\"scene\":\"detail\"}},[_c('template',{slot:\"head-title\"},[_c('i',{staticClass:\"el-icon-time\"}),_c('span',[_vm._v(\"历史版本\")])]),_c('template',{slot:\"body\"},[_c('div',{staticClass:\"m-revisions-panel\"},[(!_vm.versions || !_vm.versions.length)?_c('div',{staticClass:\"u-empty\"},[(_vm.versions === null)?_c('span',[_vm._v(\"🎉 数据加载中...\")]):_vm._e(),(_vm.versions === false)?_c('span',[_vm._v(\"⚠️ 数据加载异常\")]):_vm._e(),(_vm.versions && !_vm.versions.length)?_c('span',[_vm._v(\"💧 暂无数据\")]):_vm._e()]):_vm._e(),(_vm.versions && _vm.versions.length)?_c('table',{staticClass:\"m-histories\"},[_c('tr',[_c('th',[_vm._v(\"版本\")]),_c('th',[_vm._v(\"更新时间\")]),_c('th',[_vm._v(\"贡献者\")]),_c('th',[_vm._v(\"修订说明\")])]),_vm._l((_vm.versions),function(ver,key){return _c('tr',{key:key,staticClass:\"history\"},[_c('td',[_c('a',{attrs:{\"href\":_vm.link(_vm.type, `${ver.source_id}/${ver.id}`)},domProps:{\"textContent\":_vm._s('v' + (_vm.versions.length - key))},on:{\"click\":function($event){return _vm.redirectRevision(ver, $event)}}})]),_c('td',{domProps:{\"textContent\":_vm._s(_vm.ts2str(ver.updated))}}),_c('td',[_c('a',{attrs:{\"href\":ver.user_id ? _vm.author_url(ver.user_id) : null},domProps:{\"textContent\":_vm._s(ver.user_nickname)}})]),_c('td',{domProps:{\"textContent\":_vm._s(ver.remark)}})])})],2):_vm._e()])])],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <WikiPanel class=\"c-wiki-revisions\" scene=\"detail\">\n        <template slot=\"head-title\">\n            <i class=\"el-icon-time\"></i>\n            <span>历史版本</span>\n        </template>\n        <template slot=\"body\">\n            <div class=\"m-revisions-panel\">\n                <div class=\"u-empty\" v-if=\"!versions || !versions.length\">\n                    <span v-if=\"versions === null\">🎉 数据加载中...</span>\n                    <span v-if=\"versions === false\">⚠️ 数据加载异常</span>\n                    <span v-if=\"versions && !versions.length\">💧 暂无数据</span>\n                </div>\n                <table v-if=\"versions && versions.length\" class=\"m-histories\">\n                    <tr>\n                        <th>版本</th>\n                        <th>更新时间</th>\n                        <th>贡献者</th>\n                        <th>修订说明</th>\n                    </tr>\n                    <tr class=\"history\" v-for=\"(ver, key) in versions\" :key=\"key\">\n                        <td>\n                            <a\n                                :href=\"link(type, `${ver.source_id}/${ver.id}`)\"\n                                v-text=\"'v' + (versions.length - key)\"\n                                @click=\"redirectRevision(ver, $event)\"\n                            ></a>\n                        </td>\n                        <td v-text=\"ts2str(ver.updated)\"></td>\n                        <td>\n                            <a :href=\"ver.user_id ? author_url(ver.user_id) : null\" v-text=\"ver.user_nickname\"></a>\n                        </td>\n                        <td v-text=\"ver.remark\"></td>\n                    </tr>\n                </table>\n            </div>\n        </template>\n    </WikiPanel>\n</template>\n\n<script>\nimport WikiPanel from \"./WikiPanel\";\nimport { wiki } from \"@jx3box/jx3box-common/js/wiki\";\nimport { getLink, authorLink, ts2str } from \"@jx3box/jx3box-common/js/utils\";\nimport { __Root, __OriginRoot } from \"@jx3box/jx3box-common/data/jx3box.json\";\n\nexport default {\n    name: \"WikiRevisions\",\n    props: [\"type\", \"sourceId\", \"isGame\"],\n    data: function () {\n        return {\n            versions: null,\n        };\n    },\n    computed: {\n        client: function () {\n            return location.href.includes(\"classic\") || location.href.includes(\"origin\") ? \"origin\" : \"std\";\n        },\n        baseUrl: function () {\n            return this.client == \"origin\" ? __OriginRoot : __Root;\n        },\n        prefix: function () {\n            if (this.isGame) {\n                return this.baseUrl.slice(0, -1);\n            } else {\n                return \"\";\n            }\n        },\n    },\n    methods: {\n        link: function (type, id) {\n            return this.prefix + getLink(type, id);\n        },\n        author_url: function (uid) {\n            return this.prefix + authorLink(uid);\n        },\n        ts2str,\n        redirectRevision: function (ver, e) {\n            if (!this.isGame && this.$router) {\n                e.preventDefault();\n                this.$router.replace({ path: `/view/${ver.source_id}/${ver.id}` });\n            }\n        },\n    },\n    components: {\n        WikiPanel,\n    },\n    watch: {\n        sourceId: {\n            immediate: true,\n            handler() {\n                if (this.sourceId) {\n                    wiki.versions({ type: this.type, id: this.sourceId }, { client: this.client })\n                    .then(\n                        (res) => {\n                            res = res.data;\n                            this.versions = res.code === 200 ? res.data.versions : false;\n                        },\n                        () => {\n                            this.versions = false;\n                        }\n                    );\n                }\n            },\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"../../assets/css/wiki-revisions.less\";\n</style>\n","import mod from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./WikiRevisions.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./WikiRevisions.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./WikiRevisions.vue?vue&type=template&id=d5208e68&\"\nimport script from \"./WikiRevisions.vue?vue&type=script&lang=js&\"\nexport * from \"./WikiRevisions.vue?vue&type=script&lang=js&\"\nimport style0 from \"./WikiRevisions.vue?vue&type=style&index=0&id=d5208e68&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"component\",staticClass:\"c-map\"},[_c('div',{staticClass:\"u-map__wrapper\",style:(_vm.wrapperSize)},[_c('img',{staticClass:\"u-map-img\",attrs:{\"src\":_vm.mapImg,\"draggable\":\"false\"}}),_c('div',{staticClass:\"u-map-title__wrapper\"},[_vm._t(\"title\",function(){return [_c('div',{staticClass:\"u-map-title\"},[_vm._v(_vm._s(_vm.mapName))])]},{\"title\":_vm.mapName})],2),_vm._l((_vm.datas),function(i,k){return [_c('div',{key:k,staticClass:\"u-map-point__wrapper\",style:(_vm.pointStyle(i))},[_vm._t(\"point\",function(){return [_c('el-popover',{staticClass:\"u-map-point__popover\",attrs:{\"placement\":\"top\",\"width\":\"200\",\"trigger\":\"hover\"}},[_vm._t(\"popover\",function(){return [_c('div',[_c('div',[_vm._v(_vm._s(i.title))]),_c('div',{domProps:{\"innerHTML\":_vm._s(i.content)}})])]},{\"data\":i}),_c('span',{staticClass:\"u-map-point\",attrs:{\"slot\":\"reference\"},slot:\"reference\"})],2)]},{\"data\":i})],2)]})],2)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div ref=\"component\" class=\"c-map\">\n        <div class=\"u-map__wrapper\" :style=\"wrapperSize\">\n            <img class=\"u-map-img\" :src=\"mapImg\" draggable=\"false\" />\n            <div class=\"u-map-title__wrapper\">\n                <slot name=\"title\" v-bind:title=\"mapName\">\n                    <div class=\"u-map-title\">{{ mapName }}</div>\n                </slot>\n            </div>\n            <template v-for=\"(i, k) in datas\">\n                <div class=\"u-map-point__wrapper\" :style=\"pointStyle(i)\" :key=\"k\">\n                    <slot name=\"point\" v-bind:data=\"i\">\n                        <el-popover class=\"u-map-point__popover\" placement=\"top\" width=\"200\" trigger=\"hover\">\n                            <slot name=\"popover\" v-bind:data=\"i\">\n                                <div>\n                                    <div>{{ i.title }}</div>\n                                    <div v-html=\"i.content\"></div>\n                                </div>\n                            </slot>\n                            <span slot=\"reference\" class=\"u-map-point\"> </span>\n                        </el-popover>\n                    </slot>\n                </div>\n            </template>\n        </div>\n    </div>\n</template>\n\n<script>\nimport jx3boxData from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport mapScales from \"../data/map_scales.json\";\n\nexport default {\n    name: \"Jx3boxMap\",\n    props: {\n        mapId: {\n            type: Number,\n            default: 1,\n        },\n        datas: {\n            type: Array,\n            default: () => [],\n        },\n    },\n    data() {\n        return {\n            popoverContent: \"\",\n            width: 1024,\n            height: 896,\n        };\n    },\n    computed: {\n        subId() {\n            let scales = mapScales[this.mapId];\n            if (!scales || Object.keys(scales) <= 1) return 0;\n            let _sub = 0;\n            let _subScale = 0;\n            for (let sub in scales) {\n                let rect = {\n                    x: scales[sub].StartX,\n                    y: scales[sub].StartY,\n                    width: scales[sub].Width / scales[sub].Scale,\n                    height: scales[sub].Height / scales[sub].Scale,\n                };\n                if (this.isPointsInRect(rect) && scales[sub].Scale > _subScale) {\n                    _sub = sub;\n                    _subScale = scales[sub].Scale;\n                }\n            }\n            return _sub;\n        },\n        mapName() {\n            return mapScales[this.mapId][this.subId].Name;\n        },\n        mapScale() {\n            return mapScales[this.mapId][this.subId];\n        },\n        mapImg() {\n            return `${jx3boxData.__imgPath}map/maps/map_${this.mapId}_${this.subId}.png`;\n        },\n        wrapperSize() {\n            return {\n                width: this.width + \"px\",\n                height: this.height + \"px\",\n            };\n        },\n    },\n    mounted() {\n        this.$nextTick(function () {\n            this.updateSize();\n            window.addEventListener(\"resize\", this.updateSize);\n        });\n    },\n    beforeDestroy() {\n        window.removeEventListener(\"resize\", this.updateSize);\n    },\n    methods: {\n        pointStyle(item) {\n            const scale = this.mapScale;\n            const Width = scale.Width / scale.Scale;\n            const Height = scale.Height / scale.Scale;\n            const left = ((item.x - scale.StartX) / Width) * this.width;\n            const bottom = ((item.y - scale.StartY) / Height) * this.height;\n            return {\n                left: left + \"px\",\n                bottom: bottom + \"px\",\n            };\n        },\n        isPointsInRect(rect) {\n            let points = this.datas.map((p) => {\n                return {\n                    x: p.x,\n                    y: p.y,\n                };\n            });\n            return points.every((p) => {\n                return p.x >= rect.x && p.x <= rect.x + rect.width && p.y >= rect.y && p.y <= rect.y + rect.height;\n            });\n        },\n        updateSize() {\n            this.width = this.$refs[\"component\"]?.clientWidth;\n            if (!this.width) return;\n            this.height = this.width / (1024 / 896);\n            this.$emit(\"resize\", [this.width, this.height]);\n        },\n    },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.c-map {\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    .u-map__wrapper {\n        display: inline-block;\n        position: relative;\n        border: 1px solid rgb(238, 238, 238);\n        box-shadow: rgb(0 0 0 / 10%) 0px 0px 3px;\n        box-sizing: border-box;\n        user-select: none;\n        height: 100%;\n\n        .u-map-img {\n            display: block;\n            width: 100%;\n            height: 100%;\n            z-index: 1;\n        }\n\n        .u-map-title__wrapper {\n            z-index: 2;\n            position: absolute;\n\n            top: 16px;\n            width: 100%;\n            display: flex;\n            justify-content: center;\n\n            .u-map-title {\n                user-select: text;\n                color: #efe;\n                font-weight: bold;\n                padding: 6px;\n                background: rgba(0, 0, 0, 0.5);\n            }\n        }\n\n        .u-map-point__wrapper {\n            z-index: 3;\n            position: absolute;\n\n            .u-map-point__popover {\n                display: block;\n                width: 10px;\n                height: 10px;\n                background: #f94343;\n                border: #efe solid 1px;\n                cursor: pointer;\n                transition: all 0.1s ease-in-out;\n                &:hover {\n                    transform: scale(1.6);\n                }\n            }\n\n            .u-map-point {\n                display: block;\n                width: 10px;\n                height: 10px;\n            }\n        }\n    }\n}\n</style>\n","import mod from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./Map.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./Map.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Map.vue?vue&type=template&id=0651a7b8&scoped=true&\"\nimport script from \"./Map.vue?vue&type=script&lang=js&\"\nexport * from \"./Map.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Map.vue?vue&type=style&index=0&id=0651a7b8&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0651a7b8\",\n  null\n  \n)\n\nexport default component.exports","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('WikiPanel',{staticClass:\"c-wiki-comments\",attrs:{\"scene\":\"detail\"}},[_c('template',{slot:\"head-title\"},[_c('i',{staticClass:\"el-icon-chat-line-round\"}),_c('span',[_vm._v(\"百科评论\")])]),_c('template',{slot:\"body\"},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"m-comments-panel\"},[(!_vm.comments || !_vm.comments.length)?_c('div',{staticClass:\"u-empty\"},[(_vm.comments === null)?_c('span',[_vm._v(\"🎉 数据加载中...\")]):_vm._e(),(_vm.comments === false)?_c('span',[_vm._v(\"⚠️ 数据加载异常\")]):_vm._e(),(_vm.comments && !_vm.comments.length)?_c('span',[_vm._v(\"💧 暂无评论\")]):_vm._e()]):_vm._e(),_c('Comment',{attrs:{\"comments\":_vm.comments,\"source-id\":_vm.sourceId}}),_c('el-pagination',{staticClass:\"u-pagination-box\",attrs:{\"background\":\"\",\"hide-on-single-page\":\"\",\"current-page\":_vm.page,\"total\":_vm.total,\"page-size\":_vm.pageSize,\"layout\":\"prev, pager, next, total\"},on:{\"current-change\":_vm.handleCurrentChange}}),_c('div',{staticClass:\"m-reply-form\",attrs:{\"id\":\"m-reply-form\"}},[_c('h4',{staticClass:\"u-title\"},[_c('i',{staticClass:\"el-icon-chat-dot-round\"}),_c('span',[_vm._v(\"回复\")])]),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.reply_form.content),expression:\"reply_form.content\"}],staticClass:\"u-reply-content\",domProps:{\"value\":(_vm.reply_form.content)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.reply_form, \"content\", $event.target.value)}}}),_c('div',{staticClass:\"u-author\"},[_c('span',[_vm._v(\"昵称：\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.reply_form.user_nickname),expression:\"reply_form.user_nickname\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.reply_form.user_nickname)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.reply_form, \"user_nickname\", $event.target.value)}}})]),_c('el-button',{staticClass:\"u-submit\",attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.create_comment(_vm.reply_form)}}},[_c('i',{staticClass:\"el-icon-check\"}),_c('span',[_vm._v(\"提交\")])])],1)],1)])],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('ul',{staticClass:\"u-comments\"},_vm._l((_vm.comments),function(comment,key){return _c('li',{key:key,staticClass:\"u-comment-panel\"},[_c('div',{staticClass:\"u-comment\"},[_c('div',{staticClass:\"u-nickname-panel\"},[_c('a',{staticClass:\"u-nickname\",attrs:{\"href\":comment.user_id ? _vm.author_url(comment.user_id) : null,\"target\":\"_blank\"},domProps:{\"textContent\":_vm._s(comment.user_nickname)}}),(comment.parent_id)?[_c('span',[_vm._v(\" 回复 \")]),_c('a',{staticClass:\"u-nickname\",attrs:{\"href\":comment.parent.user_id\n                                ? _vm.author_url(comment.parent.user_id)\n                                : null,\"target\":\"_blank\"},domProps:{\"textContent\":_vm._s(comment.parent.user_nickname)}})]:_vm._e()],2),_c('p',{staticClass:\"u-content\",domProps:{\"innerHTML\":_vm._s(comment.content)}}),_c('div',{staticClass:\"m-reply\"},[(comment.reply_form && comment.reply_form.show)?_c('el-button',{staticClass:\"u-reply\",attrs:{\"type\":\"default\"},on:{\"click\":function($event){comment.reply_form.show = !comment.reply_form.show}}},[_c('i',{staticClass:\"el-icon-arrow-up\"}),_c('span',[_vm._v(\"收起\")])]):_c('el-button',{staticClass:\"u-reply\",attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":function($event){comment.reply_form.show = !comment.reply_form.show}}},[_c('i',{staticClass:\"el-icon-chat-dot-round\"}),_c('span',[_vm._v(\"回复\")])]),_c('span',{staticClass:\"u-time\",domProps:{\"textContent\":_vm._s(_vm.ts2str(comment.updated))}})],1),(comment.reply_form && comment.reply_form.show)?_c('div',{staticClass:\"m-reply-form\"},[_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(comment.reply_form.content),expression:\"comment.reply_form.content\"}],staticClass:\"u-reply-content\",domProps:{\"value\":(comment.reply_form.content)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(comment.reply_form, \"content\", $event.target.value)}}}),_c('div',{staticClass:\"u-author\"},[_c('span',[_vm._v(\"昵称：\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(comment.reply_form.user_nickname),expression:\"comment.reply_form.user_nickname\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(comment.reply_form.user_nickname)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(comment.reply_form, \"user_nickname\", $event.target.value)}}})]),_c('el-button',{staticClass:\"u-submit\",attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.create_comment(comment.reply_form, comment.id)}}},[_c('i',{staticClass:\"el-icon-check\"}),_c('span',[_vm._v(\"提交\")])])],1):_vm._e()]),(comment.children.length)?_c('WikiComment',{attrs:{\"comments\":comment.children,\"source-id\":_vm.sourceId}}):_vm._e()],1)}),0)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <ul class=\"u-comments\">\n        <li\n            class=\"u-comment-panel\"\n            v-for=\"(comment, key) in comments\"\n            :key=\"key\"\n        >\n            <div class=\"u-comment\">\n                <!-- 评论内容 -->\n                <div class=\"u-nickname-panel\">\n                    <a\n                        class=\"u-nickname\"\n                        :href=\"\n                            comment.user_id ? author_url(comment.user_id) : null\n                        \"\n                        target=\"_blank\"\n                        v-text=\"comment.user_nickname\"\n                    ></a>\n                    <template v-if=\"comment.parent_id\">\n                        <span>&nbsp;回复&nbsp;</span>\n                        <a\n                            class=\"u-nickname\"\n                            :href=\"\n                                comment.parent.user_id\n                                    ? author_url(comment.parent.user_id)\n                                    : null\n                            \"\n                            target=\"_blank\"\n                            v-text=\"comment.parent.user_nickname\"\n                        ></a>\n                    </template>\n                </div>\n                <p class=\"u-content\" v-html=\"comment.content\"></p>\n                <!-- 其他 -->\n                <div class=\"m-reply\">\n                    <!-- 展开、收起 -->\n                    <el-button\n                        type=\"default\"\n                        v-if=\"comment.reply_form && comment.reply_form.show\"\n                        class=\"u-reply\"\n                        @click=\"\n                            comment.reply_form.show = !comment.reply_form.show\n                        \"\n                    >\n                        <i class=\"el-icon-arrow-up\"></i>\n                        <span>收起</span>\n                    </el-button>\n                    <el-button\n                        type=\"primary\"\n                        plain\n                        v-else\n                        class=\"u-reply\"\n                        @click=\"\n                            comment.reply_form.show = !comment.reply_form.show\n                        \"\n                    >\n                        <i class=\"el-icon-chat-dot-round\"></i>\n                        <span>回复</span>\n                    </el-button>\n                    <!-- 更新时间 -->\n                    <span\n                        class=\"u-time\"\n                        v-text=\"ts2str(comment.updated)\"\n                    ></span>\n                </div>\n                <!-- 评论回复表单 -->\n                <div class=\"m-reply-form\" v-if=\"comment.reply_form && comment.reply_form.show\">\n                    <textarea\n                        class=\"u-reply-content\"\n                        v-model=\"comment.reply_form.content\"\n                    ></textarea>\n                    <div class=\"u-author\">\n                        <span>昵称：</span>\n                        <input\n                            v-model=\"comment.reply_form.user_nickname\"\n                            type=\"text\"\n                        />\n                    </div>\n                    <el-button\n                        type=\"primary\"\n                        class=\"u-submit\"\n                        @click=\"create_comment(comment.reply_form, comment.id)\"\n                    >\n                        <i class=\"el-icon-check\"></i>\n                        <span>提交</span>\n                    </el-button>\n                </div>\n            </div>\n            <WikiComment\n                v-if=\"comment.children.length\"\n                :comments=\"comment.children\"\n                :source-id=\"sourceId\"\n            />\n        </li>\n    </ul>\n</template>\n\n<script>\nimport { authorLink, ts2str } from \"@jx3box/jx3box-common/js/utils\";\n\nexport default {\n    name: \"WikiComment\",\n    props: [\"comments\", \"sourceId\"],\n    methods: {\n        author_url: authorLink,\n        ts2str,\n        create_comment(form, parent_id) {\n            let app = this.$parent;\n            if (!app.create_comment) app = app.$parent;\n            if (!app.create_comment) {\n                this.$message({\n                    message: \"发布评论异常，请联系管理员\",\n                    type: \"warning\",\n                });\n                return;\n            }\n            app.create_comment(form, parent_id);\n        },\n    },\n};\n</script>\n","import mod from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./WikiComment.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./WikiComment.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./WikiComment.vue?vue&type=template&id=5cfca930&\"\nimport script from \"./WikiComment.vue?vue&type=script&lang=js&\"\nexport * from \"./WikiComment.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n    <WikiPanel class=\"c-wiki-comments\" scene=\"detail\">\n        <template slot=\"head-title\">\n            <i class=\"el-icon-chat-line-round\"></i>\n            <span>百科评论</span>\n        </template>\n        <template slot=\"body\">\n            <div class=\"m-comments-panel\" v-loading=\"loading\">\n                <div class=\"u-empty\" v-if=\"!comments || !comments.length\">\n                    <span v-if=\"comments === null\">🎉 数据加载中...</span>\n                    <span v-if=\"comments === false\">⚠️ 数据加载异常</span>\n                    <span v-if=\"comments && !comments.length\">💧 暂无评论</span>\n                </div>\n                <!-- 递归评论组件 -->\n                <Comment :comments=\"comments\" :source-id=\"sourceId\" />\n                <el-pagination\n                    class=\"u-pagination-box\"\n                    background\n                    hide-on-single-page\n                    :current-page=\"page\"\n                    :total=\"total\"\n                    :page-size=\"pageSize\"\n                    layout=\"prev, pager, next, total\"\n                    @current-change=\"handleCurrentChange\"\n                ></el-pagination>\n                <!-- 回复表单 -->\n                <div id=\"m-reply-form\" class=\"m-reply-form\">\n                    <h4 class=\"u-title\">\n                        <i class=\"el-icon-chat-dot-round\"></i>\n                        <span>回复</span>\n                    </h4>\n                    <textarea\n                        class=\"u-reply-content\"\n                        v-model=\"reply_form.content\"\n                    ></textarea>\n                    <div class=\"u-author\">\n                        <span>昵称：</span>\n                        <input v-model=\"reply_form.user_nickname\" type=\"text\" />\n                    </div>\n                    <el-button\n                        type=\"primary\"\n                        class=\"u-submit\"\n                        @click=\"create_comment(reply_form)\"\n                    >\n                        <i class=\"el-icon-check\"></i>\n                        <span>提交</span>\n                    </el-button>\n                </div>\n            </div>\n        </template>\n    </WikiPanel>\n</template>\n\n<script>\nimport WikiPanel from \"./WikiPanel\";\nimport Comment from \"./WikiComment.vue\";\nimport { wikiComment } from \"@jx3box/jx3box-common/js/wiki\";\nimport User from \"@jx3box/jx3box-common/js/user\";\n\nexport default {\n    name: \"WikiComments\",\n    props: [\"type\", \"sourceId\"],\n    data() {\n        return {\n            comments: null,\n            reply_form: {\n                content: \"\",\n                user_nickname: User.getInfo().name,\n            },\n            page: 1,\n            pageSize: 10,\n            total: 0,\n            loading: false,\n        };\n    },\n    computed: {\n        client: function () {\n            return location.href.includes(\"classic\") || location.href.includes(\"origin\") ? \"origin\" : \"std\";\n        },\n    },\n    methods: {\n        get_comments() {\n            if (!this.type || !this.sourceId) return;\n            // WikiComment.list(this.type, this.sourceId, this.client)\n            this.loading = true;\n            wikiComment.list({ type: this.type, id: this.sourceId }, { client: this.client, page: this.page })\n            .then(\n                (res) => {\n                    res = res.data;\n                    if (res.code === 200) {\n                        let comments = res.data.comments;\n                        for (let i = 0; i < comments.length; i++) {\n                            comments[i][\"reply_form\"] = {\n                                show: false,\n                                content: \"\",\n                                user_nickname: User.getInfo().name,\n                            };\n                        }\n                        this.page = res.data.current_page;\n                        this.total = res.data.total\n                        this.comments = filter(comments, 0);\n                        // this.comments = comments;\n                        this.loading = false;\n                    }\n                },\n                () => {\n                    this.comments = false;\n                    this.loading = false;\n                }\n            );\n\n            function filter(comments, parent) {\n                let outputs = [];\n                for (let index in comments) {\n                    let c = comments[index];\n                    if (!c) continue;\n                    if (c.parent_id === parent) {\n                        // 递归\n                        let children = filter(c.children, c.id);\n                        c.children = children.map((item) => {\n                            item.parent = {\n                                user_id: c.user_id,\n                                user_nickname: c.user_nickname,\n                                id: c.id,\n                            }\n                            item.reply_form = {\n                                show: false,\n                                content: \"\",\n                                user_nickname: User.getInfo().name,\n                            }\n                            return item\n                        });\n                        outputs.push(c);\n                    }\n                }\n                return outputs;\n            }\n        },\n        create_comment(form, parent_id = 0) {\n            // 校验评论内容\n            if (!form.content) {\n                this.$message({\n                    message: \"请先填写评论内容再尝试提交\",\n                    type: \"warning\",\n                });\n                return;\n            }\n            const data = {\n                comment: {\n                    type: this.type,\n                    source_id: this.sourceId,\n                    parent_id: parent_id,\n                    user_nickname: form.user_nickname || User.getInfo().name,\n                    content: form.content,\n                },\n                client: this.client\n            }\n            wikiComment.post({ data }, {})\n                .then(\n                    (res) => {\n                        res = res.data;\n                        if (res.code === 200) {\n                            form.content = \"\";\n                            this.$message({\n                                message: \"提交成功，请等待审核\",\n                                type: \"success\",\n                            });\n                        } else\n                            this.$message({\n                                message: `${res.message}`,\n                                type: \"warning\",\n                            });\n                    },\n                    () => {\n                        this.$message({\n                            message: \"网络异常，提交失败\",\n                            type: \"warning\",\n                        });\n                    }\n                )\n                .finally(() => {\n                    form.show = false;\n                });\n        },\n        handleCurrentChange(page) {\n            this.page = page;\n            this.get_comments();\n        }\n    },\n    components: {\n        WikiPanel,\n        Comment,\n    },\n    watch: {\n        sourceId: {\n            immediate: true,\n            handler() {\n                this.get_comments();\n            },\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"../../assets/css/wiki-comments.less\";\n</style>\n","import mod from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./WikiComments.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./WikiComments.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./WikiComments.vue?vue&type=template&id=3ac92298&\"\nimport script from \"./WikiComments.vue?vue&type=script&lang=js&\"\nexport * from \"./WikiComments.vue?vue&type=script&lang=js&\"\nimport style0 from \"./WikiComments.vue?vue&type=style&index=0&id=3ac92298&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}