{"version":3,"sources":["webpack:///./node_modules/@jx3box/jx3box-map/src/components/Map.vue?f829","webpack:///./node_modules/@jx3box/jx3box-map/src/components/Map.vue","webpack:///node_modules/@jx3box/jx3box-map/src/components/Map.vue","webpack:///./node_modules/@jx3box/jx3box-map/src/components/Map.vue?12fe","webpack:///./node_modules/@jx3box/jx3box-map/src/components/Map.vue?c0ed","webpack:///./node_modules/core-js/modules/es.object.keys.js"],"names":["render","_vm","this","_c","_self","ref","staticClass","style","wrapperSize","attrs","mapImg","_t","_v","_s","mapName","_l","datas","i","k","key","pointStyle","title","domProps","content","slot","staticRenderFns","name","props","mapId","type","Number","default","Array","data","popoverContent","width","height","computed","subId","scales","mapScales","Object","keys","_sub","_subScale","sub","rect","x","StartX","y","StartY","Width","Scale","Height","isPointsInRect","Name","mapScale","concat","jx3boxData","__imgPath","mounted","$nextTick","updateSize","window","addEventListener","beforeDestroy","removeEventListener","methods","item","scale","left","bottom","points","map","p","every","_this$$refs$component","$refs","clientWidth","$emit","component","$","toObject","nativeKeys","fails","FAILS_ON_PRIMITIVES","target","stat","forced","it"],"mappings":"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","file":"js/chunk-30bec225.3bc4ffeb.js","sourcesContent":["export * from \"-!../../../../mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../vue-loader/lib/loaders/stylePostLoader.js!../../../../postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./Map.vue?vue&type=style&index=0&id=0651a7b8&prod&lang=less&scoped=true&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"component\",staticClass:\"c-map\"},[_c('div',{staticClass:\"u-map__wrapper\",style:(_vm.wrapperSize)},[_c('img',{staticClass:\"u-map-img\",attrs:{\"src\":_vm.mapImg,\"draggable\":\"false\"}}),_c('div',{staticClass:\"u-map-title__wrapper\"},[_vm._t(\"title\",function(){return [_c('div',{staticClass:\"u-map-title\"},[_vm._v(_vm._s(_vm.mapName))])]},{\"title\":_vm.mapName})],2),_vm._l((_vm.datas),function(i,k){return [_c('div',{key:k,staticClass:\"u-map-point__wrapper\",style:(_vm.pointStyle(i))},[_vm._t(\"point\",function(){return [_c('el-popover',{staticClass:\"u-map-point__popover\",attrs:{\"placement\":\"top\",\"width\":\"200\",\"trigger\":\"hover\"}},[_vm._t(\"popover\",function(){return [_c('div',[_c('div',[_vm._v(_vm._s(i.title))]),_c('div',{domProps:{\"innerHTML\":_vm._s(i.content)}})])]},{\"data\":i}),_c('span',{staticClass:\"u-map-point\",attrs:{\"slot\":\"reference\"},slot:\"reference\"})],2)]},{\"data\":i})],2)]})],2)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div ref=\"component\" class=\"c-map\">\n        <div class=\"u-map__wrapper\" :style=\"wrapperSize\">\n            <img class=\"u-map-img\" :src=\"mapImg\" draggable=\"false\" />\n            <div class=\"u-map-title__wrapper\">\n                <slot name=\"title\" v-bind:title=\"mapName\">\n                    <div class=\"u-map-title\">{{ mapName }}</div>\n                </slot>\n            </div>\n            <template v-for=\"(i, k) in datas\">\n                <div class=\"u-map-point__wrapper\" :style=\"pointStyle(i)\" :key=\"k\">\n                    <slot name=\"point\" v-bind:data=\"i\">\n                        <el-popover class=\"u-map-point__popover\" placement=\"top\" width=\"200\" trigger=\"hover\">\n                            <slot name=\"popover\" v-bind:data=\"i\">\n                                <div>\n                                    <div>{{ i.title }}</div>\n                                    <div v-html=\"i.content\"></div>\n                                </div>\n                            </slot>\n                            <span slot=\"reference\" class=\"u-map-point\"> </span>\n                        </el-popover>\n                    </slot>\n                </div>\n            </template>\n        </div>\n    </div>\n</template>\n\n<script>\nimport jx3boxData from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport mapScales from \"../data/map_scales.json\";\n\nexport default {\n    name: \"Jx3boxMap\",\n    props: {\n        mapId: {\n            type: Number,\n            default: 1,\n        },\n        datas: {\n            type: Array,\n            default: () => [],\n        },\n    },\n    data() {\n        return {\n            popoverContent: \"\",\n            width: 1024,\n            height: 896,\n        };\n    },\n    computed: {\n        subId() {\n            let scales = mapScales[this.mapId];\n            if (!scales || Object.keys(scales) <= 1) return 0;\n            let _sub = 0;\n            let _subScale = 0;\n            for (let sub in scales) {\n                let rect = {\n                    x: scales[sub].StartX,\n                    y: scales[sub].StartY,\n                    width: scales[sub].Width / scales[sub].Scale,\n                    height: scales[sub].Height / scales[sub].Scale,\n                };\n                if (this.isPointsInRect(rect) && scales[sub].Scale > _subScale) {\n                    _sub = sub;\n                    _subScale = scales[sub].Scale;\n                }\n            }\n            return _sub;\n        },\n        mapName() {\n            return mapScales[this.mapId][this.subId].Name;\n        },\n        mapScale() {\n            return mapScales[this.mapId][this.subId];\n        },\n        mapImg() {\n            return `${jx3boxData.__imgPath}map/maps/map_${this.mapId}_${this.subId}.png`;\n        },\n        wrapperSize() {\n            return {\n                width: this.width + \"px\",\n                height: this.height + \"px\",\n            };\n        },\n    },\n    mounted() {\n        this.$nextTick(function () {\n            this.updateSize();\n            window.addEventListener(\"resize\", this.updateSize);\n        });\n    },\n    beforeDestroy() {\n        window.removeEventListener(\"resize\", this.updateSize);\n    },\n    methods: {\n        pointStyle(item) {\n            const scale = this.mapScale;\n            const Width = scale.Width / scale.Scale;\n            const Height = scale.Height / scale.Scale;\n            const left = ((item.x - scale.StartX) / Width) * this.width;\n            const bottom = ((item.y - scale.StartY) / Height) * this.height;\n            return {\n                left: left + \"px\",\n                bottom: bottom + \"px\",\n            };\n        },\n        isPointsInRect(rect) {\n            let points = this.datas.map((p) => {\n                return {\n                    x: p.x,\n                    y: p.y,\n                };\n            });\n            return points.every((p) => {\n                return p.x >= rect.x && p.x <= rect.x + rect.width && p.y >= rect.y && p.y <= rect.y + rect.height;\n            });\n        },\n        updateSize() {\n            this.width = this.$refs[\"component\"]?.clientWidth;\n            if (!this.width) return;\n            this.height = this.width / (1024 / 896);\n            this.$emit(\"resize\", [this.width, this.height]);\n        },\n    },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.c-map {\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    .u-map__wrapper {\n        display: inline-block;\n        position: relative;\n        border: 1px solid rgb(238, 238, 238);\n        box-shadow: rgb(0 0 0 / 10%) 0px 0px 3px;\n        box-sizing: border-box;\n        user-select: none;\n        height: 100%;\n\n        .u-map-img {\n            display: block;\n            width: 100%;\n            height: 100%;\n            z-index: 1;\n        }\n\n        .u-map-title__wrapper {\n            z-index: 2;\n            position: absolute;\n\n            top: 16px;\n            width: 100%;\n            display: flex;\n            justify-content: center;\n\n            .u-map-title {\n                user-select: text;\n                color: #efe;\n                font-weight: bold;\n                padding: 6px;\n                background: rgba(0, 0, 0, 0.5);\n            }\n        }\n\n        .u-map-point__wrapper {\n            z-index: 3;\n            position: absolute;\n\n            .u-map-point__popover {\n                display: block;\n                width: 10px;\n                height: 10px;\n                background: #f94343;\n                border: #efe solid 1px;\n                cursor: pointer;\n                transition: all 0.1s ease-in-out;\n                &:hover {\n                    transform: scale(1.6);\n                }\n            }\n\n            .u-map-point {\n                display: block;\n                width: 10px;\n                height: 10px;\n            }\n        }\n    }\n}\n</style>\n","import mod from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./Map.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../cache-loader/dist/cjs.js??ref--13-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--1-0!../../../../vue-loader/lib/index.js??vue-loader-options!../../../../vue-svg-inline-loader/dist/index.min.js!./Map.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Map.vue?vue&type=template&id=0651a7b8&scoped=true&\"\nimport script from \"./Map.vue?vue&type=script&lang=js&\"\nexport * from \"./Map.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Map.vue?vue&type=style&index=0&id=0651a7b8&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0651a7b8\",\n  null\n  \n)\n\nexport default component.exports","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n"],"sourceRoot":""}