(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8e44659a"],{"11b7":function(t,e,i){"use strict";i("3bcc")},2578:function(t,e,i){},"2efc":function(t,e,i){"use strict";i("b0c0"),i("a9e3");var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-horse-card",class:"u-quality-bg--"+t.item.Quality,on:{click:function(e){return t.go(t.item)}}},[15===t.item.SubType?e("el-image",{staticClass:"u-image",attrs:{src:t.getImgSrc(t.item)}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("img",{attrs:{src:i("d47d")}})])]):e("item-icon",{attrs:{item_id:String(t.item.ItemID),isLink:!1,size:160,onlyIcon:!0}}),e("div",{staticClass:"u-name"},[t._v(t._s(t.item.Name))]),e("div",{staticClass:"u-desc"},[t._v("ID: "+t._s(t.item.ID))]),e("div",{staticClass:"u-desc"},t._l(t.item.MagicAttributes||[],(function(i,n){return e("el-tooltip",{key:n,attrs:{trigger:"hover",placement:"top"}},[e("div",{staticClass:"u-attr-pop",attrs:{slot:"content"},slot:"content"},[i.name?e("div",{staticClass:"u-attr-name"},[t._v(" "+t._s((i.name||"")+(Number(i.level)?i.level+"级":""))+" ")]):t._e(),e("div",{staticClass:"u-attr-desc"},[t._v(t._s(i.desc))])]),e("img",{staticClass:"u-attr-icon",attrs:{src:i.iconUrl,alt:i.name}})])})),1)],1)},a=[],s=(i("14d9"),i("ac1f"),i("466d"),i("5319"),i("bf15")),r={props:{item:{type:Object,required:!0}},components:{ItemIcon:s["a"]},inject:["__imgRoot","__imgRoot2"],data:function(){return{}},computed:{client:function(){return this.$store.state.client}},methods:{go:function(t){var e=t.ItemID,i=15===t.SubType?1:2;this.$router.push({path:"".concat(e),query:{type:i}})},getImgSrc:function(t){var e=t.ImgPath;if(e){var i=e.toLowerCase().match(/.*[\/,\\]homeland(.*?).tga/),n=i[1].replace(/\\/g,"/");return"default"==i[1]?this.__imgRoot+"homeland/".concat(this.client)+"/default/default.png":this.__imgRoot+"homeland/".concat(this.client)+n+".png"}return this.__imgRoot2+"".concat(this.client,"/")+t.ID+".png"},getType:function(t){var e="";return 15===t.SubType?e=0===t.DetailType?"普通坐骑":"奇趣坐骑":23===t.SubType&&(e=0===t.DetailType?"头饰":1===t.DetailType?"鞍饰":2===t.DetailType?"足饰":3===t.DetailType?"马饰":"马具"),e}}},c=r,o=(i("ea35"),i("2877")),u=Object(o["a"])(c,n,a,!1,null,null,null);e["a"]=u.exports},"3bcc":function(t,e,i){},4640:function(t,e,i){},"47f3":function(t,e,i){"use strict";i("5f08")},"5f08":function(t,e,i){},bf15:function(t,e,i){"use strict";i("99af");var n=function(){var t=this,e=t._self._c;return e("el-popover",{staticClass:"u-item",attrs:{placement:"right-start",trigger:"hover","visible-arrow":!1,"popper-class":"u-item__popup"}},[e("template",{slot:"reference"},[e("div",{staticClass:"u-item__warpper",class:{background:!t.onlyIcon,is_vertical:t.vertical}},[t.onlyName?t._e():e("a",{staticClass:"u-item-icon",style:"height:".concat(t.size,"px; width:").concat(t.size,"px"),attrs:{target:"_blank",href:t.isLink?t.getLink("item",t.source.id):t.noLink()}},[e("img",{staticClass:"u-item-icon__img",style:{height:t.size+"px",width:t.size+"px",cursor:t.isLink?"pointer":"default"},attrs:{src:t.iconLink(t.source.IconID,t.client)}}),e("div",{staticClass:"u-item-icon__quality",style:{backgroundImage:t.item_border(t.source),opacity:5==t.source.Quality?.9:1}}),e("div",{staticClass:"u-item-icon__quest",style:{backgroundImage:t.item_border_quest(t.source)}}),1!==t.display_amount?e("span",{staticClass:"u-item-icon__count"},[t._v(t._s(t.display_amount))]):t._e()]),t.onlyIcon?t._e():e("div",{staticClass:"u-item-name",class:"e-jx3-item__q".concat(t.source.Quality)},[t._v(" "+t._s(t.source.Name)+" ")])])]),e("jx3-item",{attrs:{item:t.source}})],2)},a=[],s=(i("a9e3"),i("b64b"),i("e9c4"),i("c7fa")),r=i("4ae4"),c=i("85e4"),o=i("65c2"),u={name:"ItemIcon",data:function(){return{source:{},real_id:null,maybeBook:!1}},components:{"jx3-item":s["a"]},props:{size:{type:Number,default:28},item_id:{type:String,default:null},amount:{type:Number,default:1},onlyName:{type:Boolean,default:!1},onlyIcon:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},isLink:{type:Boolean,default:!0}},methods:{noLink:function(){return!1},get_data:function(t){var e=this;t&&Object(r["a"])(t,this.client).then((function(t){var i=t.data,n=i.data.item;Object.keys(n).length&&(e.source=n,sessionStorage.setItem(e.cache_key,JSON.stringify(n)))})).catch((function(t){var i;400==(null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.code)&&!1===e.maybeBook&&(e.maybeBook=!0,e.real_id="".concat(e.item_id,"_").concat(e.amount))}))},iconLink:c["iconLink"],getLink:c["getLink"],item_border_quest:function(t){return t.IsQuest>0?"url(".concat(o["__imgPath"],"image/item/renwu.png)"):""},item_border:function(t){switch(t.Quality){case 3:return"url(".concat(o["__imgPath"],"image/item/blue.png)");case 4:return"url(".concat(o["__imgPath"],"image/item/purple.png)");case 5:return"url(".concat(o["__imgPath"],"image/item/orange.gif)");default:return""}}},computed:{client:function(){return this.$store.state.client},cache_key:function(){return"item-".concat(this.client,"-").concat(this.real_id)},display_amount:function(){return!1===this.maybeBook?this.amount:1}},watch:{real_id:{immediate:!0,handler:function(){var t=sessionStorage.getItem(this.cache_key);if(t)try{this.source=JSON.parse(t)}catch(e){console.log(e,"[Item]无法解析本地缓存"),this.get_data(this.real_id)}else this.get_data(this.real_id)}}},mounted:function(){this.real_id=this.item_id}},l=u,d=(i("c0dd"),i("2877")),p=Object(d["a"])(l,n,a,!1,null,null,null);e["a"]=p.exports},c0dd:function(t,e,i){"use strict";i("e67d")},c5f6:function(t,e,i){"use strict";i("4640")},c740:function(t,e,i){"use strict";var n=i("23e7"),a=i("b727").findIndex,s=i("44d2"),r="findIndex",c=!0;r in[]&&Array(1)[r]((function(){c=!1})),n({target:"Array",proto:!0,forced:c},{findIndex:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),s(r)},d47d:function(t,e,i){t.exports=i.p+"img/horse_item_bg_sm.1dd5cf95.jpg"},e67d:function(t,e,i){},ea35:function(t,e,i){"use strict";i("2578")},ee74:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{ref:"listRef",staticClass:"horse-list-wrapper"},[t.showSwitch?e("div",{staticClass:"operate-wrap"},[e("div",{staticClass:"list-type-wrapper"},t._l(t.listTypes,(function(i){return e("div",{key:i.value,staticClass:"list-type-item",class:t.listType===i.value&&"active",on:{click:function(e){t.listType=i.value}}},[t._v(" "+t._s(i.label)+" ")])})),0)]):t._e(),e("PvxSearch",{attrs:{items:t.searchProps,initValue:t.initValue},on:{search:function(e){return t.searchEvent(e)}}}),e("div",{staticClass:"horse-list-content"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"horse-list",class:[t.listType+"-wrap"]},["card"===t.listType?e("div",{staticClass:"list-content"},[t._l(t.list,(function(t){return e("HorseCard",{key:t.ID,attrs:{item:t}})})),e("el-button",{staticClass:"more-btn",attrs:{disabled:!t.hasNextPage,loading:t.loading,icon:"el-icon-arrow-down"},on:{click:t.loadData}},[t._v(t._s(t.hasNextPage?"加载更多":"没有更多了"))])],2):t._e(),"list"===t.listType?e("div",{staticClass:"list-content"},[e("ListHead"),t._l(t.list,(function(t){return e("HorseItem",{key:t.ID,attrs:{item:t}})})),e("pagination",{directives:[{name:"show",rawName:"v-show",value:t.totalPages>0,expression:"totalPages > 0"}],attrs:{total:t.total,page:t.query.page,limit:t.query.pageSize},on:{"update:page":function(e){return t.$set(t.query,"page",e)},"update:limit":function(e){return t.$set(t.query,"pageSize",e)},pagination:function(e){return t.findList(!1)}}})],2):t._e()])])],1)},a=[],s=i("c7eb"),r=i("1da1"),c=(i("b64b"),i("14d9"),i("d81d"),i("b0c0"),i("7db0"),i("d3b7"),i("ac1f"),i("841c"),i("25f0"),i("99af"),i("fb6a"),i("e9c4"),i("159b"),i("c740"),i("65c2"),i("f252")),o=i("2efc"),u=function(t,e){return e._m(0)},l=[function(t,e){return t("div",{staticClass:"m-list-head list-sticky-head"},[t("div",[e._v("名称")]),t("div",[e._v("类型")]),t("div",[e._v("骑乘")]),t("div",[e._v("品质等级")]),t("div",[e._v("跑速")]),t("div",[e._v("喂食饲料")]),t("div",[e._v("获取方式")]),t("div",[e._v("属性")])])}],d={name:"ListHead"},p=d,m=(i("11b7"),i("2877")),f=Object(m["a"])(p,u,l,!0,null,null,null),h=f.exports,v=(i("a9e3"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-horse-item",on:{click:function(e){return t.go(t.item)}}},[e("div",{staticClass:"u-name"},[e("item-icon",{attrs:{item_id:String(t.item.ItemID),size:36,vertical:!0}})],1),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.typeName))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.modeName))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.Level))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.speed))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.feedName))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.GetType))]),e("div",{staticClass:"u-attr-wrap"},t._l(t.item.MagicAttributes||[],(function(i,n){return e("div",{key:n,staticClass:"u-attr"},[e("el-tooltip",{attrs:{trigger:"hover",placement:"top"}},[e("div",{staticClass:"u-attr-pop",attrs:{slot:"content"},slot:"content"},[i.name?e("div",{staticClass:"u-attr-name"},[t._v(" "+t._s((i.name||"")+(Number(i.level)?i.level+"级":""))+" ")]):t._e(),e("div",{staticClass:"u-attr-desc"},[t._v(t._s(i.desc))])]),e("img",{staticClass:"u-attr-icon",attrs:{src:i.iconUrl,alt:i.name}})])],1)})),0)])}),g=[],y=i("bf15"),_={name:"HorseItem",components:{ItemIcon:y["a"]},props:{item:{type:Object,required:!0}},methods:{go:function(t){var e=t.ItemID,i=15===t.SubType?1:2;this.$router.push("/".concat(e,"/").concat(i))}},computed:{client:function(){return this.$store.state.client}}},b=_,k=(i("47f3"),Object(m["a"])(b,v,g,!1,null,null,null)),C=k.exports,w=i("d427"),I=i("ed08"),T=i("85e4"),S={name:"HorseList",props:[],components:{ListHead:h,HorseItem:C,HorseCard:o["a"],PvxSearch:w["a"]},data:function(){return{loading:!1,listType:"card",listTypes:[{value:"list",label:"列表"},{value:"card",label:"卡片"}],showSwitch:!0,feeds:[],list:[],query:{page:1,pageSize:20,client:this.client},total:0,totalPages:0,search:{},initValue:{},searchProps:[{key:"type",name:"类型",type:"radio",options:[{type:"",name:"全部"},{type:0,name:"普通坐骑"},{type:1,name:"奇趣坐骑"},{type:2,name:"马具"}]},{type:"filter",key:"filter",name:"过滤",options:[{key:"feed",type:"checkbox",name:"喂食饲料",options:[]},{key:"attr",type:"checkbox",name:"属性",options:[]}]},{key:"keyword",name:"名称/ID"}]}},computed:{hasNextPage:function(){return this.totalPages>1&&this.query.page<this.totalPages},client:function(){return this.$store.state.client}},watch:{listType:{handler:function(t){this.query.page=1,"card"===t?this.showCount():(this.query.pageSize=20,this.findList())}},search:{deep:!0,handler:function(t){return Object.keys(t).length?""===t.type?(t={},this.$router.push({path:"/"})):(this.query.page=1,void("card"===this.listType?this.showCount():(this.query.pageSize=20,this.findList()))):this.$router.push({path:"/"})}}},methods:{getAttrList:function(){var t=arguments,e=this;return Object(r["a"])(Object(s["a"])().mark((function i(){return Object(s["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.length>0&&void 0!==t[0]?t[0]:{},i.next=3,Object(c["a"])().then((function(t){var i=t.data,n=i.map((function(t){return{label:t.name,value:t.name}}));e.searchProps[1].options[1].options=n}));case 3:case"end":return i.stop()}}),i)})))()},iconLink:T["iconLink"],getFeed:function(t){var e="";return 15===t.SubType&&(e=this.feeds.find((function(e){return e.id===t.DetailType}))?this.feeds.find((function(e){return e.id===t.DetailType})).feed:""),e},canDouble:function(t){var e="";return 15===t.SubType&&t.MagicAttributes&&t.MagicAttributes.length&&(e=t.MagicAttributes.find((function(t){return"15650"===t.id}))?t.MagicAttributes.find((function(t){return"15650"===t.id})).name:"单骑"),e},getType:function(t){var e="";return 15===t.SubType?e=0===t.DetailType?"普通坐骑":"奇趣坐骑":23===t.SubType&&(e=0===t.DetailType?"头饰":1===t.DetailType?"鞍饰":2===t.DetailType?"足饰":3===t.DetailType?"马饰":"马具"),e},isPhone:I["b"],searchEvent:function(t){this.search=t},loadData:function(){this.query.page++,this.findList(!0)},findList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!0;var i=Object.assign({},this.search);for(var n in i)Array.isArray(i[n])&&(i[n]=i[n].toString());var a=Object.assign({},this.query),s=Object.assign(i,a);Object(c["d"])(Object(I["a"])(s)).then((function(i){var n=i.data.list.map((function(e){return e.typeName=t.getType(e),e.modeName=t.canDouble(e),e.feedName=t.getFeed(e),e.MoveSpeed&&(e.speed=e.MoveSpeedDesc.split("移动速度提高")[1]),e.MagicAttributes&&e.MagicAttributes.length&&e.MagicAttributes.map((function(e){return e.iconUrl=t.iconLink(e.icon),e})),e}));t.list=e?t.list.concat(n):n,t.total=i.data.total,t.totalPages=i.data.pages})).finally((function(){t.loading=!1}))},getFeedList:function(){var t=this;return Object(r["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["b"])().then((function(e){var i=e.data.map((function(t){var e=t.tip.indexOf("【"),i=t.tip.indexOf("】");return t.feed=t.tip.slice(e+1,i),t}));t.feeds=JSON.parse(JSON.stringify(i));var n=[];i.forEach((function(t){var e=n.findIndex((function(e){return e.feed===t.feed}));e>-1?n[e].id+=","+t.id:n.push(t)}));var a=n.map((function(t){return{label:t.feed,value:t.id}}));t.searchProps[1].options[0].options=a}));case 2:case"end":return e.stop()}}),e)})))()},showCount:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$nextTick((function(){var i,n=null===(i=t.$refs.listRef)||void 0===i?void 0:i.clientWidth;t.query.pageSize=4*Math.floor(n/200),e&&t.findList()}))},jdugeType:function(){var t=this;setTimeout((function(){t.showSwitch=!t.isPhone(),t.isPhone()&&(t.listType="card")}),10)}},created:function(){var t=this.$route.params;""!==t.type&&void 0!==t.type||(t.type=null),this.initValue=t},mounted:function(){var t=this;this.jdugeType();var e=this;window.onresize=function(){e.jdugeType()},this.getFeedList().then((function(){"card"===t.listType&&t.showCount(!1)})),this.getAttrList()}},x=S,j=(i("c5f6"),Object(m["a"])(x,n,a,!1,null,null,null));e["default"]=j.exports},f252:function(t,e,i){"use strict";i.d(e,"d",(function(){return s})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return o}));var n=i("41cb"),a=Object(n["e"])();function s(t){return a.get("/horses",{params:t})}function r(t){return a.get("/horse",{params:t})}function c(t){return a.get("/horse/attrs",{params:t})}function o(t){return a.get("/horse/feeds ",{params:t})}}}]);
//# sourceMappingURL=chunk-8e44659a.1f5231ac.js.map